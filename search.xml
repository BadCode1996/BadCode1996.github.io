<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Elasticsearch &amp;&amp; Kibana</title>
      <link href="/posts/202007081823.html/"/>
      <url>/posts/202007081823.html/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><h2 id="Elasticsearch"><a href="#Elasticsearch" class="headerlink" title="Elasticsearch"></a>Elasticsearch</h2><p><a href="https://www.elastic.co/cn/elasticsearch" target="_blank" rel="noopener">Elasticsearch官网</a></p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708183609.jpg" style="zoom:80%;" /><p>如上所述，Elasticsearch具备以下特点：</p><ul><li>分布式，无需人工搭建集群（solr就需要人为配置，使用Zookeeper作为注册中心）</li><li>Restful风格，一切API都遵循Rest原则，容易上手</li><li>近实时搜索，数据更新在Elasticsearch中几乎是完全同步的。</li></ul><h2 id="Kibana"><a href="#Kibana" class="headerlink" title="Kibana"></a>Kibana</h2><p><a href="https://www.elastic.co/cn/kibana" target="_blank" rel="noopener">Kibana官网</a></p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708183904.png" style="zoom:80%;" /><p>Kibana是一个基于Node.js的Elasticsearch索引库数据统计工具，可以利用Elasticsearch的聚合功能，生成各种图表，如柱形图，线状图，饼图等。</p><p>而且还提供了操作Elasticsearch索引数据的控制台，并且提供了一定的API提示，非常有利于我们学习Elasticsearch的语法。</p><h1 id="操作索引"><a href="#操作索引" class="headerlink" title="操作索引"></a>操作索引</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>Elasticsearch也是基于Lucene的全文检索库，本质也是存储数据，很多概念与MySQL类似。</p><p>对比关系</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">索引库（indices）--------------------------- 数据库（Database）</span><br><span class="line">类型（type）------------------------------- 数据表（Table）</span><br><span class="line">文档（Document）-------------------------- 行（Row）</span><br><span class="line">字段（Field）---------------------------- 列（Columns）</span><br></pre></td></tr></table></figure><p>详细说明：</p><table><thead><tr><th align="center">概念</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">索引库（indices）</td><td align="center">indices是index的复数，代表许多的索引</td></tr><tr><td align="center">类型（type）</td><td align="center">类型是模拟MySQL的table概念，一个索引库下可以有多个不同类型的索引。在Elasticsearch7版本去除了type概念</td></tr><tr><td align="center">文档（document）</td><td align="center">存入索引库原始得数据，比如每一条商品信息，就是一个文档</td></tr><tr><td align="center">字段（Field）</td><td align="center">文档中的属性，比如商品名，商品价格</td></tr><tr><td align="center">映射配置（mappings）</td><td align="center">字段的数据类型、属性、是否索引、是否存储等特性</td></tr></tbody></table><p>是不是与Lucene和Solr的概念相似</p><p>另外，在SolrCloud中，有一些集群相关概念，在Elasticsearch也有类似的：</p><ul><li>索引集（indices，index的复数）：逻辑上的完整索引</li><li>分片（shard）：数据拆分后的各个部分</li><li>副本（replica）：每个分片的复制，相当于备份</li></ul><p><strong>注意：</strong></p><p>​        Elasticsearch本身就是分布式的，即使只有一个节点，Elasticsearch默认对数据进行分片和副本操作，当向集群添加新数据时，数据也会在新加入的节点中进行平衡</p><h2 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h2><blockquote><p>语法</p></blockquote><p>ELasticsearch采用Rest风格API，因此其API就是一次http请求</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 请求方式：PUT</span><br><span class="line"># 请求路径：/索引库名</span><br><span class="line"># 请求参数：json格式</span><br><span class="line">PUT /index_name</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">"settings"</span>: &#123;</span><br><span class="line"><span class="attr">"number_of_shards"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">"number_of_replicas"</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>settings:索引库的设置<ul><li>number_of_shards：分片数量</li><li>number_of_replicas：副本数量</li></ul></li></ul><h3 id="使用Postman测试"><a href="#使用Postman测试" class="headerlink" title="使用Postman测试"></a>使用Postman测试</h3><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708213449.jpg" alt=""></p><p>可以看到创建索引成功</p><h3 id="使用Kibana创建"><a href="#使用Kibana创建" class="headerlink" title="使用Kibana创建"></a>使用Kibana创建</h3><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708214407.png" alt=""></p><p>相当于省去了elasticsearch的服务器地址，并且有语法提示</p><h2 id="查看索引设置"><a href="#查看索引设置" class="headerlink" title="查看索引设置"></a>查看索引设置</h2><blockquote><p>查看索引信息使用GET请求，语法格式：    <strong>GET /索引库名</strong></p></blockquote><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /demo# 查询索引库名为demo的索引库</span><br><span class="line">GET *# 查询所有索引库</span><br></pre></td></tr></table></figure><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button data-href="#test1-1">GET /demo</button></li><li class="tab"><button data-href="#test1-2">GET *</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p>使用 GET /demo 查询<img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708233852.png" alt=""></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p>使用 GET * 查询</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708234104.png" alt=""></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="删除索引"><a href="#删除索引" class="headerlink" title="删除索引"></a>删除索引</h2><blockquote><p>删除索引使用DELETE请求，语法格式：    <strong>DELETE /索引库名</strong></p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE /demo</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708234844.png" alt=""></p><p>再次查看demo，状态码为404，已经删除</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708235035.png" alt=""></p><blockquote><p>也可以使用HEAD请求，查看索引是否存在，语法格式：    <strong>HEAD  /索引库名</strong></p></blockquote><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200708235401.png" alt=""></p><h2 id="索引映射"><a href="#索引映射" class="headerlink" title="索引映射"></a>索引映射</h2><p>索引已经创建好了，接下来要添加数据。数据存储在索引库中，需要指定一些相关属性，包括但不限于：</p><ul><li>字段的数据类型</li><li>是否要存储</li><li>是否要索引</li><li>是否分词</li><li>分析器种类</li></ul><p>只有配置清楚，Elasticsearch才会创建数据（不一定）</p><h3 id="创建映射字段"><a href="#创建映射字段" class="headerlink" title="创建映射字段"></a>创建映射字段</h3><blockquote><p>创建映射字段使用的是PUT请求，语法格式：</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PUT /索引库名/_mapping/类型名称# Elasticsearch6之前使用</span><br><span class="line">PUT /索引库名/_mapping/# Elasticsearch7之后使用,7版本之后，去除了type</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">"properties"</span>:&#123;</span><br><span class="line"><span class="attr">"字段名"</span>:&#123;</span><br><span class="line"><span class="attr">"type"</span>: <span class="string">"类型"</span>,</span><br><span class="line"><span class="attr">"index"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="attr">"analyaer"</span>: <span class="string">"分词器"</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>类型名称：type的概念，类似于MySQL中的数据表（table）</li><li>字段名：Field的概念，类似于MySQL中的行，属性名<ul><li>type：类型，可选值有text、long、short、date、integer、object等</li><li>index：是否索引，默认为true，可不写</li><li>store：是否存储，默认为false，可不写</li><li>analyer：分词器，这里使用的<code>ik_max_word</code>就是<code>ik分词器</code></li></ul></li></ul><p>示例</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709001656.png" alt=""></p><h3 id="查看映射关系"><a href="#查看映射关系" class="headerlink" title="查看映射关系"></a>查看映射关系</h3><blockquote><p>查看映射关系使用GET请求，语法格式：    <strong>GET /索引库名/_mapping</strong></p></blockquote><p>示例：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_mapping</span><br></pre></td></tr></table></figure><p>响应</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709003533.png" alt=""></p><h3 id="字段属性详解"><a href="#字段属性详解" class="headerlink" title="字段属性详解"></a>字段属性详解</h3><ul><li><p>type</p><p>Elasticsearch中支持的数据类型非常丰富：</p><p>官方文档地址：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html" target="_blank" rel="noopener">type官方文档地址</a></p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709010522.png" alt=""></p><ul><li>String类型，又分两种<ul><li>text：可分词，不可参与聚合</li><li>keyword：不可分词，数据会作为完整字段进行匹配，可以参与聚合</li></ul></li><li>Numeric：数值类型<ul><li>基本数据类型：long、integer、short、byte、double、float、half_float</li><li>浮点数的高精度类型：scaled_float<ul><li>需要指定一个精度因子，比如10或100，Elasticsearch会把真实值乘以这个因子后存储，取出时再还原</li></ul></li></ul></li><li>Date：日期类型<ul><li>Elasticsearch可以对日期格式化为字符串存储，但是建议我们存储为毫秒值，存储为long，节省空间</li></ul></li></ul></li><li><p>index</p><p>index影响字段的索引情况</p><p>官方文档地址：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-index.html" target="_blank" rel="noopener">index官方文档地址</a></p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709111041.png" alt=""></p><ul><li>true：字段会被索引，则可以用来进行搜索，默认值为true</li><li>false：字段不会被索引，不可以用来进行搜索 </li></ul></li><li><p>store</p><p>是否将字段进行额外存储。</p><p>官方文档地址：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-store.html" target="_blank" rel="noopener">store官方文档地址</a></p><p>在Lucene和Solr中，如果一个字段的<code>store</code>设置为<code>false</code>，那么在文档列表中就不会有这个字段的值，搜索结果中也不会显示出来。</p><p>但在Elasticsearch中，即使字段的<code>store</code>设置为<code>false</code>，也可以搜索到结果。</p><p>因为Elasticsearch在创建文档索引时，会将文档中的原始数据备份，保存到一个叫<code>_source</code>的属性中。可以通过过滤<code>_source</code>来选择哪些要显示，哪些不显示。</p><p>如果<code>store</code>设置为<code>true</code>，就会在<code>_source</code>以外额外存储一份数据，会很多余，因此，一般都将<code>store</code>设置为<code>false</code>，其默认值也为<code>false</code></p></li><li><p>boost</p><p>官方文档地址：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-boost.html" target="_blank" rel="noopener">boost官方文档地址</a></p><p>激励因子，在查询时，可以使用<code>boost</code>参数自动增强各个字段（对相关性得分进行计算）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PUT my_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"mappings"</span>: &#123;</span><br><span class="line">    <span class="string">"properties"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: &#123;</span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">        <span class="string">"boost"</span>: 2</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">"content"</span>: &#123;</span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"text"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>title</code>字段上的匹配的权重是<code>content</code>的2倍，默认<code>boost</code>值为1.0</p><div class="note warning icon"><p>boost仅应用于术语查询(前缀、范围和模糊查询不被增强)。</p></div></li></ul><h2 id="新增数据"><a href="#新增数据" class="headerlink" title="新增数据"></a>新增数据</h2><h3 id="随机生成id"><a href="#随机生成id" class="headerlink" title="随机生成id"></a>随机生成id</h3><blockquote><p>通过POST请求，可以向一个已经存在的索引库中添加数据，语法格式：</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /索引库名/_doc</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"key"</span>: <span class="string">"value"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /demo1/_doc</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"title"</span>: <span class="string">"华为手机"</span>,</span><br><span class="line">  <span class="string">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">  <span class="string">"price"</span>: 4999.00</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709134709.png" alt=""></p><p>查看数据：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709135324.png" alt=""></p><p>其中：</p><ul><li><code>_source</code>：源文档信息，所有数据都在这里</li><li><code>_id</code>：这条文档的唯一标识，与文档自己的<code>id</code>字段没有任何关联</li></ul><h3 id="自定义id"><a href="#自定义id" class="headerlink" title="自定义id"></a>自定义id</h3><blockquote><p>也可以在新增数据的时候自定义id，语法格式：</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /索引库名/_doc/id</span><br><span class="line">&#123;</span><br><span class="line"><span class="code">"key": "value"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /demo1/_doc/10011</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"title"</span>: <span class="string">"华为手机"</span>,</span><br><span class="line">  <span class="string">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">  <span class="string">"price"</span>: 4999.00</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709135818.png" alt=""></p><div class="note danger icon"><p>图太多了，就不传图了，使用代码块来展示</p></div><p>查看数据：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET _search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line"><span class="string">"match_all"</span>: &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"_index"</span> : <span class="string">"demo1"</span>,</span><br><span class="line">    <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">    <span class="attr">"_id"</span> : <span class="string">"10010"</span>,</span><br><span class="line">    <span class="attr">"_score"</span> : <span class="number">0.18232156</span>,</span><br><span class="line"><span class="attr">"_source"</span> : &#123;</span><br><span class="line">        <span class="attr">"title"</span> : <span class="string">"华为手机"</span>,</span><br><span class="line">        <span class="attr">"images"</span> : <span class="string">"images/1.jpg"</span>,</span><br><span class="line">        <span class="attr">"price"</span> : <span class="number">4999.0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中，<code>_id</code>属性值为自定义id</p><h3 id="智能判断"><a href="#智能判断" class="headerlink" title="智能判断"></a>智能判断</h3><p>在Solr中，新增数据只能使用提前配置好的映射属性的字段，否则就会报错。</p><p>但在Elasticsearch中，并没有这样的规则。Elasticsearch非常智能，不需要给索引库设置任何mapping映射，它可以根据输入的数据内容来判断数据类型，动态添加数据映射。</p><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST /demo1/_doc/10010</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"title"</span>: <span class="string">"华为手机"</span>,</span><br><span class="line">  <span class="string">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">  <span class="string">"price"</span>: 4999.00,</span><br><span class="line">  <span class="string">"stock"</span>: 200,</span><br><span class="line">  <span class="string">"saleable"</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>额外添加了<code>stock</code>和<code>saleable</code>两个字段。</p><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"_index"</span> : <span class="string">"demo1"</span>,</span><br><span class="line">    <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">    <span class="attr">"_id"</span> : <span class="string">"10010"</span>,</span><br><span class="line">    <span class="attr">"_score"</span> : <span class="number">0.2876821</span>,</span><br><span class="line">    <span class="attr">"_source"</span> : &#123;</span><br><span class="line">        <span class="attr">"title"</span> : <span class="string">"华为手机"</span>,</span><br><span class="line">        <span class="attr">"images"</span> : <span class="string">"images/1.jpg"</span>,</span><br><span class="line">        <span class="attr">"price"</span> : <span class="number">4999.0</span>,</span><br><span class="line">        <span class="attr">"stock"</span> : <span class="number">200</span>,</span><br><span class="line">        <span class="attr">"saleable"</span> : <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再次查看索引库映射关系</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询语句</span></span><br><span class="line">GET /demo1/_mapping</span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"demo1"</span> : &#123;</span><br><span class="line">    <span class="string">"mappings"</span> : &#123;</span><br><span class="line">      <span class="string">"properties"</span> : &#123;</span><br><span class="line">        <span class="string">"images"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"keyword"</span>,</span><br><span class="line">          <span class="string">"index"</span> : <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"price"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"float"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"saleable"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"boolean"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"stock"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"long"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"title"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"text"</span>,</span><br><span class="line">          <span class="string">"analyzer"</span> : <span class="string">"ik_max_word"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>stock</code>和<code>saleable</code>都被成功映射了。</p><h2 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h2><blockquote><p>修改数据使用 PUT请求，语法格式：</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PUT /索引库名/_doc/id值</span><br><span class="line">&#123;</span><br><span class="line"><span class="code">"key": "value"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>如果id对应的文档存在，则修改</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709150601.png" alt=""></p></li><li><p>如果id对应的文档不存在，则新增</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200709150637.png" alt=""></p></li></ul><h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><blockquote><p>删除数据使用 DELETE请求，语法格式：</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE /索引库名/_doc/id值</span><br></pre></td></tr></table></figure><p>示例：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200710093800.png" alt=""></p><h1 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h1><h2 id="基本查询"><a href="#基本查询" class="headerlink" title="基本查询"></a>基本查询</h2><blockquote><p>基本语法</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /索引库名/_search</span><br><span class="line">&#123;</span><br><span class="line"><span class="code">"query":&#123;</span></span><br><span class="line"><span class="code">"查询类型": &#123;</span></span><br><span class="line"><span class="code">"查询条件": "查询条件值"</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>query</code>代表一个查询对象，里面可以有不同的查询属性</p><ul><li>查询类型：<code>match</code>、<code>match_all</code>、<code>term</code>、<code>range</code>等等</li><li>查询条件：查询条件会根据类型的不同，写法也有所不同。</li></ul><h3 id="查询所有-match-all"><a href="#查询所有-match-all" class="headerlink" title="查询所有 match_all"></a>查询所有 match_all</h3><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"query"</span>: &#123;</span><br><span class="line"><span class="string">"match_all"</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>query</code>：代表查询对象</li><li><code>match_all</code>：代表查询所有</li></ul><p>结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"took"</span> : <span class="number">3</span>,</span><br><span class="line">  <span class="attr">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : <span class="number">3</span>,</span><br><span class="line">    <span class="attr">"successful"</span> : <span class="number">3</span>,</span><br><span class="line">    <span class="attr">"skipped"</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"hits"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : &#123;</span><br><span class="line">      <span class="attr">"value"</span> : <span class="number">4</span>,</span><br><span class="line">      <span class="attr">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"max_score"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="attr">"hits"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"demo1"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"10010"</span>,</span><br><span class="line">        <span class="attr">"_score"</span> : <span class="number">1.0</span>,</span><br><span class="line">        <span class="attr">"_source"</span> : &#123;</span><br><span class="line">          <span class="attr">"title"</span> : <span class="string">"华为手机"</span>,</span><br><span class="line">          <span class="attr">"images"</span> : <span class="string">"images/1.jpg"</span>,</span><br><span class="line">          <span class="attr">"price"</span> : <span class="number">4999.0</span>,</span><br><span class="line">          <span class="attr">"stock"</span> : <span class="number">200</span>,</span><br><span class="line">          <span class="attr">"saleable"</span> : <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"demo1"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"10012"</span>,</span><br><span class="line">        <span class="attr">"_score"</span> : <span class="number">1.0</span>,</span><br><span class="line">        <span class="attr">"_source"</span> : &#123;</span><br><span class="line">          <span class="attr">"title"</span> : <span class="string">"华为手机"</span>,</span><br><span class="line">          <span class="attr">"images"</span> : <span class="string">"images/1.jpg"</span>,</span><br><span class="line">          <span class="attr">"price"</span> : <span class="number">4999.0</span>,</span><br><span class="line">          <span class="attr">"stock"</span> : <span class="number">200</span>,</span><br><span class="line">          <span class="attr">"saleable"</span> : <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"demo1"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"llAgMnMBTqiphn18iYVc"</span>,</span><br><span class="line">        <span class="attr">"_score"</span> : <span class="number">1.0</span>,</span><br><span class="line">        <span class="attr">"_source"</span> : &#123;</span><br><span class="line">          <span class="attr">"title"</span> : <span class="string">"华为手机"</span>,</span><br><span class="line">          <span class="attr">"images"</span> : <span class="string">"images/1.jpg"</span>,</span><br><span class="line">          <span class="attr">"price"</span> : <span class="number">4999.0</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"demo1"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"10011"</span>,</span><br><span class="line">        <span class="attr">"_score"</span> : <span class="number">1.0</span>,</span><br><span class="line">        <span class="attr">"_source"</span> : &#123;</span><br><span class="line">          <span class="attr">"title"</span> : <span class="string">"华为手机"</span>,</span><br><span class="line">          <span class="attr">"images"</span> : <span class="string">"images/1.jpg"</span>,</span><br><span class="line">          <span class="attr">"price"</span> : <span class="number">4999.0</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>took</code>：查询花费时间</li><li><code>time_out</code>：是否超时</li><li><code>_shards</code>：分片信息</li><li><code>hits</code>：搜索结果总览对象<ul><li><code>total</code>：搜索到的总条数</li><li><code>max_score</code>：所有搜索到的文档中得分的最高分</li><li><code>hits</code>：搜索结果的文档对象数组，每个元素是一条搜索到的文档信息<ul><li><code>_index</code>：索引库</li><li><code>_type</code>：文档类型</li><li><code>_id</code>：文档id</li><li><code>_score</code>：文档得分</li><li><code>_source</code>：文档的源数据</li></ul></li></ul></li></ul><h3 id="匹配查询-match"><a href="#匹配查询-match" class="headerlink" title="匹配查询 match"></a>匹配查询 match</h3><p>查看当前文档数据</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200713012105.png" alt=""></p><ul><li>or 关系</li></ul><blockquote><p>使用<code>match</code>类型查询，会把查询条件进行分词，然后进行查询，多个词条之间是<strong>or关系</strong></p></blockquote><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: <span class="string">"小米手机"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10001"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.3862942</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">5999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">1500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span> : <span class="string">"10005"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电饭煲"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">399.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">3000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10004"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.5753642</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">3999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面的案例中，把查询条件“小米手机”分词成 小米 和 手机 两个词，与这两个词相关的文档都会被查到，多个词之间是<strong>or关系</strong></p><ul><li>and 关系</li></ul><blockquote><p>某些情况下，需要更精确的查找，希望这个关系变成<strong>and关系</strong></p></blockquote><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: &#123;</span><br><span class="line">        <span class="string">"query"</span>: <span class="string">"小米手机"</span>,</span><br><span class="line">        <span class="string">"operator"</span>: <span class="string">"and"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10004"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.5753642</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">3999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>只有同时包含 <code>小米</code>和<code>手机</code>两个词的文档才能被查询到</p><ul><li>or 和 and 之间</li></ul><p>在 <code>or</code> 与 <code>and</code> 间二者选择一个，有些片面。如果用户给出的查询条件分词后，有5个词，想查找只包含其中4个词的文档，如何处理？将<code>operator</code>设置为and，只会将文档排除。</p><p>有时候这正是我们所期望的，在全文检索中，既想包含哪些可能相关的文档，同时又想排除哪些不太相关的文档，换句话说，想要查询某些中间结果。</p><p><code>match</code>查询支持<code>minimum_should_match</code>最小匹配参数，这样可以指定必须匹配的词项数用来表示一个文档是否相关，可以将其设为某个具体数字，更常用的方法时设置为百分数，因为无法控制用户搜索时给出的搜索条件的词数。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: &#123;</span><br><span class="line">        <span class="string">"query"</span>: <span class="string">"小米手机电视盒子"</span>,</span><br><span class="line">        <span class="string">"minimum_should_match"</span>: <span class="string">"40%"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10004"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.5753642</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">3999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>本例中，搜索语句可以分6个词，如果使用and关系，需要同时满足6个词才能被搜索到，这里使用了最小匹配参数：40%，也就是只要匹配到总分词数的40%即可，6*40% 约等于 2，只要包含2个分词即可</p><h3 id="多字段查询-multi-match"><a href="#多字段查询-multi-match" class="headerlink" title="多字段查询 multi_match"></a>多字段查询 multi_match</h3><blockquote><p><code>multi_match</code> 与 <code>match</code>类似，不同的是它可以在多个字段中查询</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"multi_match"</span>: &#123;</span><br><span class="line">      <span class="string">"query"</span>: <span class="string">"华为"</span>,</span><br><span class="line">      <span class="string">"fields"</span>: [<span class="string">"title"</span>,<span class="string">"subtitle"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>本例中，会在<code>title</code>和<code>subtitle</code>中查询<code>华为</code>这个词</p><h3 id="词条匹配-term"><a href="#词条匹配-term" class="headerlink" title="词条匹配 term"></a>词条匹配 term</h3><blockquote><p><code>term</code>被用于精确值匹配，这些精确值可能是数字、时间、布尔或者那些<strong>没有分词</strong>的字符串</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"term"</span>: &#123;</span><br><span class="line">      <span class="string">"price"</span>: &#123;</span><br><span class="line">        <span class="string">"value"</span>: <span class="string">"1999.00"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">2500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="多词条精确匹配-terms"><a href="#多词条精确匹配-terms" class="headerlink" title="多词条精确匹配 terms"></a>多词条精确匹配 terms</h3><blockquote><p><code>terms</code>和<code>term</code>查询一样，但<code>terms</code>允许指定多值匹配，如果这个字段包含了指定值中的任意一个值，那么这个文档就满足条件</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"terms"</span>: &#123;</span><br><span class="line">      <span class="string">"price"</span>: [</span><br><span class="line">        1999.00,</span><br><span class="line">        2999.00,</span><br><span class="line">        3999.00</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">2500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10004"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.5753642</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">3999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="结果过滤"><a href="#结果过滤" class="headerlink" title="结果过滤"></a>结果过滤</h2><p>默认情况下，Elasticsearch在搜索的结果中，会把文档中保存在<code>_source</code>的所有字段都返回。</p><p>如果想要获取其中的部分字段，可以添加<code>_source</code>的过滤</p><h3 id="直接指定字段"><a href="#直接指定字段" class="headerlink" title="直接指定字段"></a>直接指定字段</h3><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_source"</span>: [<span class="string">"title"</span>,<span class="string">"price"</span>],</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"term"</span>: &#123;</span><br><span class="line">      <span class="string">"price"</span>: 1999.00</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：<code>_source</code>中只有<code>title</code>和<code>price</code>两个字段</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="指定includes和excludes"><a href="#指定includes和excludes" class="headerlink" title="指定includes和excludes"></a>指定includes和excludes</h3><p>也可以通过：</p><ul><li>includes：用于指定将要显示的字段</li></ul><p>示例</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_source"</span>: &#123;</span><br><span class="line">  <span class="string">"includes"</span>: [<span class="string">"title"</span>,<span class="string">"price"</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"term"</span>: &#123;</span><br><span class="line">      <span class="string">"price"</span>: 1999.00</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>excludes：用于指定不想显示的字段</li></ul><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_source"</span>: &#123;</span><br><span class="line">  <span class="string">"excludes"</span>: [<span class="string">"images"</span>,<span class="string">"saleable"</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"term"</span>: &#123;</span><br><span class="line">      <span class="string">"price"</span>: 1999.00</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span> : <span class="number">2500</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span> : <span class="number">5000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="高级查询"><a href="#高级查询" class="headerlink" title="高级查询"></a>高级查询</h2><h3 id="布尔查询-bool"><a href="#布尔查询-bool" class="headerlink" title="布尔查询 bool"></a>布尔查询 bool</h3><p><code>bool</code>把其他各种查询通过<code>must</code>（与）、<code>should</code>（或）、<code>must_not</code>（非）的方式进行组合</p><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"must"</span>: [</span><br><span class="line">        &#123;<span class="string">"match"</span>: &#123;<span class="string">"title"</span>: <span class="string">"华为"</span>&#125;&#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"must_not"</span>: [</span><br><span class="line">        &#123;<span class="string">"match"</span>: &#123;<span class="string">"title"</span>: <span class="string">"电视"</span>&#125;&#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"should"</span>: [</span><br><span class="line">        &#123;<span class="string">"match"</span>: &#123;<span class="string">"title"</span>: <span class="string">"手机"</span>&#125;&#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10001"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">5999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">1500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10002"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为盒子"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">499.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">1500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="范围查询-range"><a href="#范围查询-range" class="headerlink" title="范围查询 range"></a>范围查询 range</h3><p><code>range</code>查询找出那些落在指定区域的数字或者时间</p><p>示例：查询<code>price</code>字段值处于[1000,5000]之间的文档</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"range"</span>: &#123;</span><br><span class="line">      <span class="string">"price"</span>: &#123;</span><br><span class="line">        <span class="string">"gte"</span>: 1000,</span><br><span class="line">        <span class="string">"lte"</span>: 5000</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>range</code>查询允许一下字符</p><ul><li>gt        大于</li><li>gte      大于等于</li><li>lt         小于</li><li>lte       小于等于</li></ul><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">2500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10004"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.5753642</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">3999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="模糊查询-fuzzy"><a href="#模糊查询-fuzzy" class="headerlink" title="模糊查询 fuzzy"></a>模糊查询 fuzzy</h3><p>新增一条数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PUT /demo1/_doc/10007</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"title"</span>: <span class="string">"iphone手机"</span>,</span><br><span class="line">  <span class="string">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">  <span class="string">"price"</span>: 8999.00,</span><br><span class="line">  <span class="string">"stock"</span>: 5000,</span><br><span class="line">  <span class="string">"saleable"</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>fuzzy</code>查询是<code>term</code>查询的模糊等价。它允许用户搜索词条与实际词条的拼写出现偏差，但是偏差的编辑距离不得超过2</p><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"fuzzy"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: <span class="string">"iphana"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10007"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.2837042</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"iphone手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">8999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>也可以通过<code>fuzziness</code>来指定允许的编辑距离，取值[0,2]</p><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"fuzzy"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: &#123;</span><br><span class="line">        <span class="string">"value"</span>: <span class="string">"iphama"</span>,</span><br><span class="line">        <span class="string">"fuzziness"</span>: 2</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10007"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.2837042</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"iphone手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">8999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="过滤-filter"><a href="#过滤-filter" class="headerlink" title="过滤 filter"></a>过滤 filter</h2><blockquote><p>条件查询中，进行过滤</p></blockquote><p>所有的查询条件都会影响到文档的评分及排名。如果需要在查询中进行过滤，并且不希望过滤条件影响评分，那么就不要把过滤条件作为查询条件来使用。而是使用<code>filter</code>方式</p><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"must"</span>: [</span><br><span class="line">        &#123;<span class="string">"match"</span>: &#123;<span class="string">"title"</span>: <span class="string">"华为"</span>&#125;&#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"filter"</span>: [</span><br><span class="line">        &#123;<span class="string">"range"</span>: &#123;</span><br><span class="line">          <span class="string">"price"</span>: &#123;</span><br><span class="line">            <span class="string">"gt"</span>: 100,</span><br><span class="line">            <span class="string">"lte"</span>: 1999</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>filter</code>中还可以再次进行<code>bool</code>组合条件过滤查询</p><blockquote><p>无查询条件，直接过滤</p></blockquote><p>如果一次查询只有过滤，没有查询条件，<strong>不希望进行评分</strong>，可以使用<code>constant_score</code>取代只有<code>filter</code>语句的<code>bool</code>查询。性能上时完全相同的，但对于提高查询简洁性和清晰性有很大帮助</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"constant_score"</span>: &#123;</span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"range"</span>: &#123;</span><br><span class="line">          <span class="string">"price"</span>: &#123;</span><br><span class="line">            <span class="string">"gte"</span>: 1000,</span><br><span class="line">            <span class="string">"lte"</span>: 2000</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">2500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.87546873</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><h3 id="单字段排序"><a href="#单字段排序" class="headerlink" title="单字段排序"></a>单字段排序</h3><p><code>sort</code>可以按照不同的字段进行排序，并且通过<code>order</code>指定排序方式</p><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: <span class="string">"华为"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"sort"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"price"</span>: &#123;</span><br><span class="line">        <span class="string">"order"</span>: <span class="string">"desc"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10001"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">5999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">1500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">2500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10002"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为盒子"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">499.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">1500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="多字段排序"><a href="#多字段排序" class="headerlink" title="多字段排序"></a>多字段排序</h3><p>假设想结合<code>_score</code>和<code>price</code>进行查询，并且匹配的结果首先按照价格排序，然后按照得分排序</p><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /demo1/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match"</span>: &#123;<span class="string">"title"</span>: <span class="string">"华为电视"</span>&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"sort"</span>: [</span><br><span class="line">    &#123;<span class="string">"price"</span>: &#123;<span class="string">"order"</span>: <span class="string">"asc"</span>&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">"_score"</span>: &#123;<span class="string">"order"</span>: <span class="string">"desc"</span>&#125;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10002"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.6931471</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为盒子"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">499.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">1500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"sort"</span>: [</span><br><span class="line">    <span class="number">499.0</span>,</span><br><span class="line">    <span class="number">0.6931471</span></span><br><span class="line">  ]</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span> : <span class="string">"10003"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.7227666</span>,</span><br><span class="line">  <span class="attr">"_source"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">2500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"sort"</span>: [</span><br><span class="line">    <span class="number">1999.0</span>,</span><br><span class="line">    <span class="number">1.7227666</span></span><br><span class="line">  ]</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10006"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">1.0296195</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"小米电视"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">1999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">5000</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"sort"</span>: [</span><br><span class="line">    <span class="number">1999.0</span>,</span><br><span class="line">    <span class="number">1.0296195</span></span><br><span class="line">  ]</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span>: <span class="string">"demo1"</span>,</span><br><span class="line">  <span class="attr">"_type"</span>: <span class="string">"_doc"</span>,</span><br><span class="line">  <span class="attr">"_id"</span>: <span class="string">"10001"</span>,</span><br><span class="line">  <span class="attr">"_score"</span>: <span class="number">0.6931471</span>,</span><br><span class="line">  <span class="attr">"_source"</span> : &#123;</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"华为手机"</span>,</span><br><span class="line">    <span class="attr">"images"</span>: <span class="string">"images/1.jpg"</span>,</span><br><span class="line">    <span class="attr">"price"</span>: <span class="number">5999.0</span>,</span><br><span class="line">    <span class="attr">"stock"</span>: <span class="number">1500</span>,</span><br><span class="line">    <span class="attr">"saleable"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"sort"</span>: [</span><br><span class="line">    <span class="number">5999.0</span>,</span><br><span class="line">    <span class="number">0.6931471</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="聚合aggregations"><a href="#聚合aggregations" class="headerlink" title="聚合aggregations"></a>聚合aggregations</h1><p>聚合可以更方便的实现对数据的统计、分析。例如：</p><ul><li>什么品牌的手机更受欢迎</li><li>这些手机的平均价格，最高价格，最低价格</li><li>这些手机每月的销量如何</li></ul><p>实现这些统计功能要比数据库的SQL简单得多，而且查询速度非常快，近乎实时搜索效果</p><h2 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h2><p>Elasticsearch中的聚合，包含多种类型，最常用的有两种：<code>桶</code>、<code>度量</code></p><blockquote><p><code>桶(bucket)</code>,阿里文档称之为存储单元</p></blockquote><p>桶的作用，是按照某种方式对数据进行分组，每一组数据在Elasticsearch中称之为一个<strong>桶</strong></p><p>Elasticsearch中提供的划分桶的方式有很多：</p><ul><li>Data Histogram Aggregation：根据日期阶梯分组，例如给定阶梯为周，会自动每周分为一个存储单元</li><li>Histogram Aggregation：根据数值阶梯分组，与日期类似</li><li>Terms Aggregation：根据词条内容分组，词条内容完全匹配的为一个存储单元</li><li>Range Aggregation：数值和日期的范围分组，指定开始和结束，然后按段分</li><li>…..</li></ul><p>综上所述，发现bucket aggregations 只负责对数据进行分组，不负责计算，因此bucket中往往会嵌套另一种集合：metrics aggregations，即度量</p><blockquote><p>度量(metrics)</p></blockquote><p>分组完成后，需要对组内的元素进行聚合运算，例如求平均值、最大最小值、求和等，这些在Elasticsearch中称之为<code>度量</code></p><p>比较常用的聚合度量方式：</p><ul><li>Avg Aggregation：求平均值</li><li>Max Aggregation：求最大值</li><li>Min Aggregation：求最小值</li><li>Percentiles Aggregation：求百分比</li><li>Stats Aggregation：同时返回avg、max、min、sum、count等</li><li>Sum Aggregation：求和</li><li>Top hits Aggregation：求前几</li><li>Value count Aggregation：求总数</li><li>……</li></ul><br><p>为了测试聚合，先创建数据：</p><ul><li>创建索引</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PUT cars</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"settings"</span>: &#123;</span><br><span class="line">    <span class="string">"number_of_shards"</span>: 1,</span><br><span class="line">    <span class="string">"number_of_replicas"</span>: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"mappings"</span>: &#123;</span><br><span class="line">    <span class="string">"properties"</span>: &#123;</span><br><span class="line">      <span class="string">"color"</span>: &#123;</span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"keyword"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">"make"</span>: &#123;</span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"keyword"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="snote info"><p>在Elasticsearch中，需要进行聚合、排序、过滤的字段其处理方式比较特殊，因此不能被分词。这里将`color`、`mark`这两个字段类型设置为keyword，这个类型不会被分词，将来可以参与聚合</p></div><ul><li>导入数据</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /cars/_bulk</span><br><span class="line">&#123; <span class="string">"index"</span>: &#123;&#125;&#125;</span><br><span class="line">&#123; <span class="string">"price"</span> : 10000, <span class="string">"color"</span> : <span class="string">"red"</span>, <span class="string">"make"</span> : <span class="string">"honda"</span>, <span class="string">"sold"</span> : <span class="string">"2014-10-28"</span> &#125;</span><br><span class="line">&#123; <span class="string">"index"</span>: &#123;&#125;&#125;</span><br><span class="line">&#123; <span class="string">"price"</span> : 20000, <span class="string">"color"</span> : <span class="string">"red"</span>, <span class="string">"make"</span> : <span class="string">"honda"</span>, <span class="string">"sold"</span> : <span class="string">"2014-11-05"</span> &#125;</span><br><span class="line">&#123; <span class="string">"index"</span>: &#123;&#125;&#125;</span><br><span class="line">&#123; <span class="string">"price"</span> : 30000, <span class="string">"color"</span> : <span class="string">"green"</span>, <span class="string">"make"</span> : <span class="string">"ford"</span>, <span class="string">"sold"</span> : <span class="string">"2014-05-18"</span> &#125;</span><br><span class="line">&#123; <span class="string">"index"</span>: &#123;&#125;&#125;</span><br><span class="line">&#123; <span class="string">"price"</span> : 15000, <span class="string">"color"</span> : <span class="string">"blue"</span>, <span class="string">"make"</span> : <span class="string">"toyota"</span>, <span class="string">"sold"</span> : <span class="string">"2014-07-02"</span> &#125;</span><br><span class="line">&#123; <span class="string">"index"</span>: &#123;&#125;&#125;</span><br><span class="line">&#123; <span class="string">"price"</span> : 12000, <span class="string">"color"</span> : <span class="string">"green"</span>, <span class="string">"make"</span> : <span class="string">"toyota"</span>, <span class="string">"sold"</span> : <span class="string">"2014-08-19"</span> &#125;</span><br><span class="line">&#123; <span class="string">"index"</span>: &#123;&#125;&#125;</span><br><span class="line">&#123; <span class="string">"price"</span> : 20000, <span class="string">"color"</span> : <span class="string">"red"</span>, <span class="string">"make"</span> : <span class="string">"honda"</span>, <span class="string">"sold"</span> : <span class="string">"2014-11-05"</span> &#125;</span><br><span class="line">&#123; <span class="string">"index"</span>: &#123;&#125;&#125;</span><br><span class="line">&#123; <span class="string">"price"</span> : 80000, <span class="string">"color"</span> : <span class="string">"red"</span>, <span class="string">"make"</span> : <span class="string">"bmw"</span>, <span class="string">"sold"</span> : <span class="string">"2014-01-01"</span> &#125;</span><br><span class="line">&#123; <span class="string">"index"</span>: &#123;&#125;&#125;</span><br><span class="line">&#123; <span class="string">"price"</span> : 25000, <span class="string">"color"</span> : <span class="string">"blue"</span>, <span class="string">"make"</span> : <span class="string">"ford"</span>, <span class="string">"sold"</span> : <span class="string">"2014-02-12"</span> &#125;</span><br></pre></td></tr></table></figure><h2 id="聚合为桶"><a href="#聚合为桶" class="headerlink" title="聚合为桶"></a>聚合为桶</h2><p>按照汽车的颜色<code>color</code>来进行分组</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /cars/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"size"</span>: 0,</span><br><span class="line">  <span class="string">"aggs"</span>: &#123;</span><br><span class="line">    <span class="string">"populer_color"</span>: &#123;</span><br><span class="line">      <span class="string">"terms"</span>: &#123;</span><br><span class="line">        <span class="string">"field"</span>: <span class="string">"color"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>size：查询条数，这里设置为0，因为不关心搜索到的数据，只关心聚合结果，提高效率</li><li>aggs：声明这是一个聚合查询，是aggregations的缩写<ul><li>popular_color：给这次聚合自定义一个名字，任意写。<ul><li>terms：划分桶的方式，这里是根据词条划分<ul><li>field：划分桶的字段</li></ul></li></ul></li></ul></li></ul><p>结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"took"</span> : <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"skipped"</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"hits"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : &#123;</span><br><span class="line">      <span class="attr">"value"</span> : <span class="number">8</span>,</span><br><span class="line">      <span class="attr">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"max_score"</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="attr">"populer_color"</span> : &#123;</span><br><span class="line">      <span class="attr">"doc_count_error_upper_bound"</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"sum_other_doc_count"</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"buckets"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"red"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">4</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"blue"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">2</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"green"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>hits：查询结果为空，因为设置了size为0</li><li>aggregations：聚合的结果</li><li>populer_color：自定义的聚合名称</li><li>buckets：查询到的桶，每个不同的color字段值都会形成一个桶<ul><li>key：这个桶对应的color字段值</li><li>doc_count：这个桶中文档的数量</li></ul></li></ul><p>例如：通过聚合发现，目前红色汽车比较畅销</p><h2 id="桶内度量"><a href="#桶内度量" class="headerlink" title="桶内度量"></a>桶内度量</h2><p>上面的案例可以获取每个桶里面的文档数量，通常应用程序需要提供更复杂的文档度量。例如：每种颜色汽车的平均价格是多少？</p><p>因此，需要告诉Elasticsearch使用<code>哪个字段</code>、<code>使用哪种度量方式</code>进行计算，这些信息要嵌套在<code>桶</code>内，度量的计算会基于桶内的文档进行</p><blockquote><p>例如：求每种颜色汽车的平均价格</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GET /cars/_search</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"size"</span>: 0,</span><br><span class="line"><span class="string">"aggs"</span>: &#123;</span><br><span class="line"><span class="string">"populer_color"</span>: &#123;</span><br><span class="line"><span class="string">"terms"</span>:&#123;</span><br><span class="line"><span class="string">"field"</span>: <span class="string">"color"</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">"aggs"</span>: &#123;</span><br><span class="line"><span class="string">"avg_price"</span>: &#123;</span><br><span class="line"><span class="string">"avg"</span>: &#123;</span><br><span class="line"><span class="string">"field"</span>: <span class="string">"price"</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>aggs：在上一个aggs（populer_color）中添加新的aggs，可见度量也是一种聚合</li><li>avg_price：聚合的名称，自定义</li><li>avg：度量的类型</li><li>field：度量运算的字段</li></ul><p>计算结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"took"</span> : <span class="number">1</span>,</span><br><span class="line">  <span class="attr">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"_shards"</span> : &#123;<span class="attr">"total"</span> : <span class="number">1</span>,<span class="attr">"successful"</span> : <span class="number">1</span>,<span class="attr">"skipped"</span> : <span class="number">0</span>,<span class="attr">"failed"</span> : <span class="number">0</span>&#125;,</span><br><span class="line">  <span class="attr">"hits"</span> : &#123;<span class="attr">"total"</span> : &#123;<span class="attr">"value"</span> : <span class="number">8</span>,<span class="attr">"relation"</span> : <span class="string">"eq"</span>&#125;,<span class="attr">"max_score"</span> : <span class="literal">null</span>,<span class="attr">"hits"</span> : [ ]&#125;,</span><br><span class="line">  <span class="attr">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="attr">"populer_color"</span> : &#123;</span><br><span class="line">      <span class="attr">"doc_count_error_upper_bound"</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"sum_other_doc_count"</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"buckets"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"red"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">4</span>,</span><br><span class="line">          <span class="attr">"avg_price"</span> : &#123;</span><br><span class="line">            <span class="attr">"value"</span> : <span class="number">32500.0</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"blue"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"avg_price"</span> : &#123;</span><br><span class="line">            <span class="attr">"value"</span> : <span class="number">20000.0</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"green"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"avg_price"</span> : &#123;</span><br><span class="line">            <span class="attr">"value"</span> : <span class="number">21000.0</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="snote info"><p>由此可见，每个桶中都有自己的avg_price字段，这是度量聚合的结果</p></div><h2 id="桶内嵌套桶"><a href="#桶内嵌套桶" class="headerlink" title="桶内嵌套桶"></a>桶内嵌套桶</h2><p>刚才的案例是在桶里嵌套度量运算。实际上桶不仅可以嵌套度量运算，还可以再嵌套其他桶，也就是每个分组中，还可以有其他组</p><blockquote><p>例如：统计每个颜色的汽车的平均价格，以及分别属于哪个制造商</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GET /cars/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"size"</span>: 0,</span><br><span class="line">  <span class="string">"aggs"</span>: &#123;</span><br><span class="line">    <span class="string">"populer_color"</span>: &#123;</span><br><span class="line">      <span class="string">"terms"</span>: &#123;<span class="string">"field"</span>: <span class="string">"color"</span>&#125;,</span><br><span class="line">      <span class="string">"aggs"</span>: &#123;</span><br><span class="line">        <span class="string">"avg_price"</span>: &#123;<span class="string">"avg"</span>: &#123;<span class="string">"field"</span>: <span class="string">"price"</span>&#125;&#125;,</span><br><span class="line">        <span class="string">"maker"</span>: &#123;<span class="string">"terms"</span>: &#123;<span class="string">"field"</span>: <span class="string">"make"</span>&#125;&#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>原来的color桶和avg计算不变</li><li>maker：在嵌套的aggs下添加新的桶</li><li>terms：桶的划分类型</li><li>field：根据什么字段划分</li></ul><p>运算结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"took"</span> : <span class="number">5</span>,</span><br><span class="line">  <span class="attr">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"skipped"</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"hits"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : &#123;</span><br><span class="line">      <span class="attr">"value"</span> : <span class="number">8</span>,</span><br><span class="line">      <span class="attr">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"max_score"</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="attr">"populer_color"</span> : &#123;</span><br><span class="line">      <span class="attr">"doc_count_error_upper_bound"</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"sum_other_doc_count"</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"buckets"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"red"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">4</span>,</span><br><span class="line">          <span class="attr">"maker"</span> : &#123;</span><br><span class="line">            <span class="attr">"doc_count_error_upper_bound"</span> : <span class="number">0</span>,</span><br><span class="line">            <span class="attr">"sum_other_doc_count"</span> : <span class="number">0</span>,</span><br><span class="line">            <span class="attr">"buckets"</span> : [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"key"</span> : <span class="string">"honda"</span>,</span><br><span class="line">                <span class="attr">"doc_count"</span> : <span class="number">3</span></span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"key"</span> : <span class="string">"bmw"</span>,</span><br><span class="line">                <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">"avg_price"</span> : &#123;</span><br><span class="line">            <span class="attr">"value"</span> : <span class="number">32500.0</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"blue"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"maker"</span> : &#123;</span><br><span class="line">            <span class="attr">"doc_count_error_upper_bound"</span> : <span class="number">0</span>,</span><br><span class="line">            <span class="attr">"sum_other_doc_count"</span> : <span class="number">0</span>,</span><br><span class="line">            <span class="attr">"buckets"</span> : [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"key"</span> : <span class="string">"ford"</span>,</span><br><span class="line">                <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"key"</span> : <span class="string">"toyota"</span>,</span><br><span class="line">                <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">"avg_price"</span> : &#123;</span><br><span class="line">            <span class="attr">"value"</span> : <span class="number">20000.0</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="string">"green"</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"maker"</span> : &#123;</span><br><span class="line">            <span class="attr">"doc_count_error_upper_bound"</span> : <span class="number">0</span>,</span><br><span class="line">            <span class="attr">"sum_other_doc_count"</span> : <span class="number">0</span>,</span><br><span class="line">            <span class="attr">"buckets"</span> : [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"key"</span> : <span class="string">"ford"</span>,</span><br><span class="line">                <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"key"</span> : <span class="string">"toyota"</span>,</span><br><span class="line">                <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">"avg_price"</span> : &#123;</span><br><span class="line">            <span class="attr">"value"</span> : <span class="number">21000.0</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>新聚合的maker嵌套在原来的每一个color中</li><li>每个颜色下都根据maker进行了分组</li><li>查询结果信息：<ul><li>红色汽车一共有4辆</li><li>红色汽车平均价格为32500</li><li>其中有3辆制造商是Honda，1辆是BMW</li></ul></li></ul><h2 id="划分桶的其他方式"><a href="#划分桶的其他方式" class="headerlink" title="划分桶的其他方式"></a>划分桶的其他方式</h2><p>前面讲了，划分桶的方式有很多，例如：</p><ul><li>Data Histogram Aggregation：根据日期阶梯分组，例如给定阶梯为周，会自动每周分为一个存储单元</li><li>Histogram Aggregation：根据数值阶梯分组，与日期类似</li><li>Terms Aggregation：根据词条内容分组，词条内容完全匹配的为一个存储单元</li><li>Range Aggregation：数值和日期的范围分组，指定开始和结束，然后按段分</li></ul><p>之前的案例中，采用的是Terms Aggregation，根据词条内容分组。</p><p>再来看一下其他划分桶的方式</p><h3 id="阶梯分桶Histogram"><a href="#阶梯分桶Histogram" class="headerlink" title="阶梯分桶Histogram"></a>阶梯分桶Histogram</h3><blockquote><p>原理：HIstogram是把数值类型的字段，按照一定的阶梯大小进行分组，需要知道一个阶梯值（interval）来划分阶梯大小</p></blockquote><p>例如：</p><p>有一个价格字段，如果设定interval的值为200，那么阶梯值是：</p><p>0、200、400、600、…..</p><p>上面列出的是每个阶梯的key，也是区间启点。</p><p>如果一件商品的价格为450，会落在哪个区间呢？</p><p>计算公式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bucket_key &#x3D; Math.floor((value - offset) &#x2F; interval) * interval + offset</span><br></pre></td></tr></table></figure><ul><li>value：就是当前数据的值，本案例中指450</li><li>offset：起始偏移量，默认为0</li><li>interval：阶梯间隔，比如200</li></ul><p>所以，得到的结果为 key = Math.floor((450 -0) / 200) * 200 + 0 = 400</p><blockquote><p>示例：对汽车价格进行分组，指定interval为10000</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">GET /cars/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"size"</span>: 0,</span><br><span class="line">  <span class="string">"aggs"</span>: &#123;</span><br><span class="line">    <span class="string">"price"</span>: &#123;</span><br><span class="line">      <span class="string">"histogram"</span>: &#123;</span><br><span class="line">        <span class="string">"field"</span>: <span class="string">"price"</span>,</span><br><span class="line">        <span class="string">"interval"</span>: 10000</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"took"</span> : <span class="number">1</span>,</span><br><span class="line">  <span class="attr">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"skipped"</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"hits"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : &#123;</span><br><span class="line">      <span class="attr">"value"</span> : <span class="number">8</span>,</span><br><span class="line">      <span class="attr">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"max_score"</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="attr">"price"</span> : &#123;</span><br><span class="line">      <span class="attr">"buckets"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">10000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">3</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">20000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">3</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">30000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">40000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">50000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">60000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">70000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">80000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class='tip warning'><p>发现查询结果中，有大量空的分组，可以增加一个参数<b>min_doc_count</b>为1，这样文档数量为0的桶会被过滤掉<p></div><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GET /cars/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"size"</span>: 0,</span><br><span class="line">  <span class="string">"aggs"</span>: &#123;</span><br><span class="line">    <span class="string">"price"</span>: &#123;</span><br><span class="line">      <span class="string">"histogram"</span>: &#123;</span><br><span class="line">        <span class="string">"field"</span>: <span class="string">"price"</span>,</span><br><span class="line">        <span class="string">"interval"</span>: 10000,</span><br><span class="line">        <span class="string">"min_doc_count"</span>: 1</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"took"</span> : <span class="number">1</span>,</span><br><span class="line">  <span class="attr">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"skipped"</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"hits"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : &#123;</span><br><span class="line">      <span class="attr">"value"</span> : <span class="number">8</span>,</span><br><span class="line">      <span class="attr">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"max_score"</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="attr">"price"</span> : &#123;</span><br><span class="line">      <span class="attr">"buckets"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">10000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">3</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">20000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">3</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">30000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"key"</span> : <span class="number">80000.0</span>,</span><br><span class="line">          <span class="attr">"doc_count"</span> : <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用Kibana可视化图表查看：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200716150435.png" alt=""></p><h3 id="范围分桶Range"><a href="#范围分桶Range" class="headerlink" title="范围分桶Range"></a>范围分桶Range</h3><p>范围分桶与阶梯分桶类似</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200716155539007.png" alt="image-20200716155539007"></p><h1 id="Spring-Data-Elasticsearch"><a href="#Spring-Data-Elasticsearch" class="headerlink" title="Spring Data Elasticsearch"></a>Spring Data Elasticsearch</h1><p>Elasticsearch提供的Java客户端有一些不太方便的地方</p><ul><li>很多地方需要拼接Json字符串</li><li>需要把对象序列化为Json存储</li><li>查询到的结果也需要反序列化为对象</li></ul><h2 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h2><p>Spring Data Elasticsearch是Spring Data项目下的一个子模块</p><p>查看Spring Data官网：<a href="https://spring.io/projects/spring-data" target="_blank" rel="noopener">Spring Data官网</a></p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200716160508092.png" alt="image-20200716160508092"></p><p>Spring Data 的使命是给各种数据访问提供统一的编程接口，不管是关系型数据库（如MySQL）、还是非关系型数据库（如Redis）、或者类似Elasticsearch这样的索引数据库。从而简化开发人员的代码，提高开发效率。</p><p>Spring Data包含了很多不同数据操作的模块：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200716161620604.png" alt="image-20200716161620604"></p><p>Spring Data Elasticsearch的页面：<a href="https://spring.io/projects/spring-data-elasticsearch" target="_blank" rel="noopener">Spring Data Elasticsearch</a></p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200716161901011.png" alt="image-20200716161901011"></p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200716163522602.png" alt="image-20200716163522602"></p><h2 id="创建Demo工程"><a href="#创建Demo工程" class="headerlink" title="创建Demo工程"></a>创建Demo工程</h2><p>新建一个demo，创建Elasticsearch工程</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200716164249158.png" alt="image-20200716164249158"></p><p>pom依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.code.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>启动类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Application<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>application.yml配置文件：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">data:</span></span><br><span class="line">    <span class="attr">elasticsearch:</span></span><br><span class="line">      <span class="comment"># 已弃用</span></span><br><span class="line">      <span class="attr">cluster-name:</span> <span class="string">my-application</span></span><br><span class="line">      <span class="attr">cluster-nodes:</span> <span class="number">192.168</span><span class="number">.40</span><span class="number">.77</span><span class="string">:9300</span></span><br></pre></td></tr></table></figure><h2 id="索引操作"><a href="#索引操作" class="headerlink" title="索引操作"></a>索引操作</h2><h3 id="创建索引和映射"><a href="#创建索引和映射" class="headerlink" title="创建索引和映射"></a>创建索引和映射</h3><blockquote><p>实体类</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">    Long id;</span><br><span class="line">    String title; <span class="comment">//标题</span></span><br><span class="line">    String category;<span class="comment">// 分类</span></span><br><span class="line">    String brand; <span class="comment">// 品牌</span></span><br><span class="line">    Double price; <span class="comment">// 价格</span></span><br><span class="line">    String images; <span class="comment">// 图片地址</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// TODO get and set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>映射</p></blockquote><p>Spring Data通过注解来声明字段的映射属性：</p><ul><li><p><code>@Document</code>：作用于类，标记实体类为文档对象，一般有两个属性</p><ul><li>indexName：对应索引库名称</li><li>type：对应在索引库中的类型</li><li>shards：分片数量，默认为5</li><li>replicas：副本数量，默认为1</li></ul></li><li><p><code>@Id</code>：作用成员变量，标记一个字段作为id主键</p></li><li><p><code>@Field</code>：作用在成员变量，标记为文档的字段，并制定字段映射属性：</p><ul><li>type：字段类型，是枚举类<code>FieldType</code></li><li>index：是否索引，默认为true</li><li>store：是否存储，默认为false</li><li>analyzer：分词器名称</li></ul></li></ul><p>示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Document</span>(indexName = <span class="string">"item"</span>,shards = <span class="number">1</span>,replicas = <span class="number">0</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    Long id;</span><br><span class="line">    <span class="meta">@Field</span>(type = FieldType.Text,analyzer = <span class="string">"ik_max_word"</span>)</span><br><span class="line">    String title;</span><br><span class="line">    <span class="meta">@Field</span>(type = FieldType.Keyword)</span><br><span class="line">    String category;</span><br><span class="line">    <span class="meta">@Field</span>(type = FieldType.Keyword)</span><br><span class="line">    String brand;</span><br><span class="line">    <span class="meta">@Field</span>(type = FieldType.Double)</span><br><span class="line">    Double price;</span><br><span class="line">    <span class="meta">@Field</span>(type = FieldType.Keyword,index = <span class="keyword">false</span>)</span><br><span class="line">    String images;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注入bean</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ElasticsearchRestTemplate restTemplate;</span><br></pre></td></tr></table></figure><blockquote><p>创建索引</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//  设置索引信息（绑定实体类），返回IndexOperations</span></span><br><span class="line">     IndexOperations indexOperations = restTemplate.indexOps(Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//  创建索引</span></span><br><span class="line">indexOperations.create();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>可以根据类的信息自动生成，也可以手动指定</li></ul><p><img src= "/img/loading.gif" data-src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200716193632823.png" alt="image-20200716193632823"></p><blockquote><p>创建映射</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createMapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//  设置索引信息（绑定实体类），返回IndexOperations</span></span><br><span class="line">    IndexOperations indexOperations = restTemplate.indexOps(Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//    创建索引映射</span></span><br><span class="line">Document mapping = indexOperations.createMapping();</span><br><span class="line"><span class="comment">//    写入索引</span></span><br><span class="line">    indexOperations.putMapping(mapping);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>完整代码</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span>(<span class="title">classes</span> </span>= Application<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">CreateIndexTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ElasticsearchRestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//        设置索引信息（绑定实体类），返回IndexOperations</span></span><br><span class="line">        IndexOperations indexOperations = restTemplate.indexOps(Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//        创建索引</span></span><br><span class="line">        indexOperations.create();</span><br><span class="line"><span class="comment">//        创建索引映射</span></span><br><span class="line">        Document mapping = indexOperations.createMapping();</span><br><span class="line"><span class="comment">//        写入索引</span></span><br><span class="line">        indexOperations.putMapping(mapping);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p> 在Kibana中查询，查询语句：GET /item</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"item"</span> : &#123;</span><br><span class="line">    <span class="attr">"aliases"</span> : &#123; &#125;,</span><br><span class="line">    <span class="attr">"mappings"</span> : &#123;</span><br><span class="line">      <span class="attr">"properties"</span> : &#123;</span><br><span class="line">        <span class="attr">"brand"</span> : &#123;</span><br><span class="line">          <span class="attr">"type"</span> : <span class="string">"keyword"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"category"</span> : &#123;</span><br><span class="line">          <span class="attr">"type"</span> : <span class="string">"keyword"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"images"</span> : &#123;</span><br><span class="line">          <span class="attr">"type"</span> : <span class="string">"keyword"</span>,</span><br><span class="line">          <span class="attr">"index"</span> : <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"price"</span> : &#123;</span><br><span class="line">          <span class="attr">"type"</span> : <span class="string">"double"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"title"</span> : &#123;</span><br><span class="line">          <span class="attr">"type"</span> : <span class="string">"text"</span>,</span><br><span class="line">          <span class="attr">"analyzer"</span> : <span class="string">"ik_max_word"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"settings"</span> : &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"refresh_interval"</span> : <span class="string">"1s"</span>,</span><br><span class="line">        <span class="attr">"number_of_shards"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="attr">"provided_name"</span> : <span class="string">"item"</span>,</span><br><span class="line">        <span class="attr">"creation_date"</span> : <span class="string">"1594898975335"</span>,</span><br><span class="line">        <span class="attr">"store"</span> : &#123;</span><br><span class="line">          <span class="attr">"type"</span> : <span class="string">"fs"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"number_of_replicas"</span> : <span class="string">"0"</span>,</span><br><span class="line">        <span class="attr">"uuid"</span> : <span class="string">"-CFLXqVhSFuluymWNevDYg"</span>,</span><br><span class="line">        <span class="attr">"version"</span> : &#123;</span><br><span class="line">          <span class="attr">"created"</span> : <span class="string">"7080099"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="删除索引-1"><a href="#删除索引-1" class="headerlink" title="删除索引"></a>删除索引</h3><blockquote><p>示例：</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//    设置索引信息（绑定实体类），返回IndexOperations</span></span><br><span class="line">    IndexOperations indexOperations = restTemplate.indexOps(Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//    删除索引</span></span><br><span class="line">    indexOperations.delete();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>结果：404 - Not Found</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"error"</span> : &#123;</span><br><span class="line">    <span class="attr">"root_cause"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"type"</span> : <span class="string">"index_not_found_exception"</span>,</span><br><span class="line">        <span class="attr">"reason"</span> : <span class="string">"no such index [item]"</span>,</span><br><span class="line">        <span class="attr">"resource.type"</span> : <span class="string">"index_or_alias"</span>,</span><br><span class="line">        <span class="attr">"resource.id"</span> : <span class="string">"item"</span>,</span><br><span class="line">        <span class="attr">"index_uuid"</span> : <span class="string">"_na_"</span>,</span><br><span class="line">        <span class="attr">"index"</span> : <span class="string">"item"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"type"</span> : <span class="string">"index_not_found_exception"</span>,</span><br><span class="line">    <span class="attr">"reason"</span> : <span class="string">"no such index [item]"</span>,</span><br><span class="line">    <span class="attr">"resource.type"</span> : <span class="string">"index_or_alias"</span>,</span><br><span class="line">    <span class="attr">"resource.id"</span> : <span class="string">"item"</span>,</span><br><span class="line">    <span class="attr">"index_uuid"</span> : <span class="string">"_na_"</span>,</span><br><span class="line">    <span class="attr">"index"</span> : <span class="string">"item"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"status"</span> : <span class="number">404</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="新增文档数据"><a href="#新增文档数据" class="headerlink" title="新增文档数据"></a>新增文档数据</h2><h3 id="Repository接口"><a href="#Repository接口" class="headerlink" title="Repository接口"></a>Repository接口</h3><p>Spring Data 的强大之处在于不同写任何DAO处理，可以自动根据方法名或类的信息进行CRUD操作。只要定义一个接口，然后继承Repository提供的一些子接口，就能具备各种基本的CRUD功能。</p><p>Repository继承关系：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717001327328.png" alt="image-20200717001327328"></p><p>其中，ElasticsearchRepository接口：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717002829448.png" alt="image-20200717002829448"></p><blockquote><p> 自定义接口，继承ElasticsearchRepository</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ItemRepository</span> <span class="keyword">extends</span> <span class="title">ElasticsearchRepository</span>&lt;<span class="title">Item</span>,<span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来，就可以新增数据了</p><h3 id="新增一个文档"><a href="#新增一个文档" class="headerlink" title="新增一个文档"></a>新增一个文档</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ItemRepository repository;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Item item = <span class="keyword">new</span> Item(<span class="number">1L</span>,<span class="string">"华为手机"</span>,<span class="string">"手机"</span>,<span class="string">"华为"</span>,<span class="number">4999.00</span>,<span class="string">"http://image.badcode.icu/13123.jpg"</span>);</span><br><span class="line">    repository.save(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在Kibana中查询</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET /item/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match_all"</span>: &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"took"</span> : <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"skipped"</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"hits"</span> : &#123;</span><br><span class="line">    <span class="attr">"total"</span> : &#123;</span><br><span class="line">      <span class="attr">"value"</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"max_score"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="attr">"hits"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"item"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"_doc"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="attr">"_score"</span> : <span class="number">1.0</span>,</span><br><span class="line">        <span class="attr">"_source"</span> : &#123;</span><br><span class="line">          <span class="attr">"_class"</span> : <span class="string">"com.code.bean.Item"</span>,</span><br><span class="line">          <span class="attr">"id"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"title"</span> : <span class="string">"华为手机"</span>,</span><br><span class="line">          <span class="attr">"category"</span> : <span class="string">"手机"</span>,</span><br><span class="line">          <span class="attr">"brand"</span> : <span class="string">"华为"</span>,</span><br><span class="line">          <span class="attr">"price"</span> : <span class="number">4999.0</span>,</span><br><span class="line">          <span class="attr">"images"</span> : <span class="string">"http://image.badcode.icu/13123.jpg"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="批量新增文档"><a href="#批量新增文档" class="headerlink" title="批量新增文档"></a>批量新增文档</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Item&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    list.add(<span class="keyword">new</span> Item(<span class="number">2L</span>, <span class="string">"坚果手机R1"</span>, <span class="string">" 手机"</span>, <span class="string">"锤子"</span>, <span class="number">3999.00</span>,<span class="string">"http://image.badcode.icu/13123.jpg"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Item(<span class="number">3L</span>, <span class="string">"小米手机"</span>, <span class="string">" 手机"</span>, <span class="string">"小米"</span>, <span class="number">1999.00</span>, <span class="string">"http://image.badcode.icu/13123.jpg"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Item(<span class="number">4L</span>, <span class="string">"iphone手机"</span>, <span class="string">" 手机"</span>, <span class="string">"Apple"</span>, <span class="number">8999.00</span>, <span class="string">"http://image.badcode.icu/13123.jpg"</span>));</span><br><span class="line">    repository.saveAll(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在Kibana中查询，共有4条数据</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717004513867.png" alt="image-20200717004513867"></p><h3 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h3><p>修改和新增是同一个接口，区分的依据就是id。跟在页面发起PUT请求是类似的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Item item = <span class="keyword">new</span> Item(<span class="number">4L</span>, <span class="string">"苹果手机"</span>, <span class="string">" 手机"</span>, <span class="string">"Apple"</span>, <span class="number">8999.00</span>, <span class="string">"http://image.badcode.icu/13123.jpg"</span>);</span><br><span class="line">    repository.save(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>如果id存在，则修改；不存在则新增</li></ul><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717004943453.png" alt="image-20200717004943453"></p><h2 id="查询-1"><a href="#查询-1" class="headerlink" title="查询"></a>查询</h2><h3 id="基本查询-1"><a href="#基本查询-1" class="headerlink" title="基本查询"></a>基本查询</h3><p>ElasticsearchRepository提供了一些基本的查询方法</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717005859538.png" alt="image-20200717005859538"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询所有</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Iterable&lt;Item&gt; items = repository.findAll();</span><br><span class="line">    <span class="keyword">for</span> (Item item : items) &#123;</span><br><span class="line">        System.out.println(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询结果：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717010237379.png" alt="image-20200717010237379"></p><h3 id="自定义方法"><a href="#自定义方法" class="headerlink" title="自定义方法"></a>自定义方法</h3><p>Spring Data的另一个强大之处，是根据方法名自动实现功能。</p><p>例如：方法名是：findByTitle，那么它就知道是根据title来查询，然后帮你自动完成，无需写实现类</p><div class='tip warning'><p>注意：方法名要符合约束<p></div><p><a href="https://docs.spring.io/spring-data/elasticsearch/docs/4.0.1.RELEASE/reference/html/#elasticsearch.query-methods.criterions" target="_blank" rel="noopener">官方参考文档地址</a></p><table><thead><tr><th>Keyword</th><th>Sample</th><th>Elasticsearch Query String</th></tr></thead><tbody><tr><td><code>And</code></td><td><code>findByNameAndPrice</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;price&quot; : &quot;?&quot;}} ]}}</code></td></tr><tr><td><code>Or</code></td><td><code>findByNameOrPrice</code></td><td><code>{&quot;bool&quot; : {&quot;should&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;price&quot; : &quot;?&quot;}} ]}}</code></td></tr><tr><td><code>Is</code></td><td><code>findByName</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}</code></td></tr><tr><td><code>Not</code></td><td><code>findByNameNot</code></td><td><code>{&quot;bool&quot; : {&quot;must_not&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}</code></td></tr><tr><td><code>Between</code></td><td><code>findByPriceBetween</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>LessThanEqual</code></td><td><code>findByPriceLessThan</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>GreaterThanEqual</code></td><td><code>findByPriceGreaterThan</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : null,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>Before</code></td><td><code>findByPriceBefore</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>After</code></td><td><code>findByPriceAfter</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : null,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>Like</code></td><td><code>findByNameLike</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;?*&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>StartingWith</code></td><td><code>findByNameStartingWith</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;?*&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>EndingWith</code></td><td><code>findByNameEndingWith</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;*?&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>Contains/Containing</code></td><td><code>findByNameContaining</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;**?**&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>In</code></td><td><code>findByNameIn(Collection&lt;String&gt;names)</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;bool&quot; : {&quot;should&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}} ]}}}}</code></td></tr><tr><td><code>NotIn</code></td><td><code>findByNameNotIn(Collection&lt;String&gt;names)</code></td><td><code>{&quot;bool&quot; : {&quot;must_not&quot; : {&quot;bool&quot; : {&quot;should&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}}}</code></td></tr><tr><td><code>Near</code></td><td><code>findByStoreNear</code></td><td><code>Not Supported Yet !</code></td></tr><tr><td><code>True</code></td><td><code>findByAvailableTrue</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : true}}}}</code></td></tr><tr><td><code>False</code></td><td><code>findByAvailableFalse</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : false}}}}</code></td></tr><tr><td><code>OrderBy</code></td><td><code>findByAvailableTrueOrderByNameDesc</code></td><td><code>{&quot;sort&quot; : [{ &quot;name&quot; : {&quot;order&quot; : &quot;desc&quot;} }],&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : true}}}}</code></td></tr></tbody></table><blockquote><p>例如：按照价格区间查询</p></blockquote><p>定义方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ItemRepository</span> <span class="keyword">extends</span> <span class="title">ElasticsearchRepository</span>&lt;<span class="title">Item</span>,<span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据价格区间查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> price1</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> price2</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Item&gt; <span class="title">findByPriceBetween</span><span class="params">(<span class="keyword">double</span> price1, <span class="keyword">double</span> price2)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Item&gt; items = repository.findByPriceBetween(<span class="number">1000.00</span>, <span class="number">4000.00</span>);</span><br><span class="line">    <span class="keyword">for</span> (Item item : items) &#123;</span><br><span class="line">        System.out.println(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717011438719.png" alt="image-20200717011438719"></p><h3 id="自定义查询"><a href="#自定义查询" class="headerlink" title="自定义查询"></a>自定义查询</h3><p>有关Query的构造器，发现Query接口共有1个抽象类和3个实现类</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717012714123.png" alt="image-20200717012714123"></p><p>可以通过 <code>new NativeSearchQueryBuilder()</code> 来构建 <code>NativeSearchQuery</code>对象</p><p><code>NativeSearchQuery</code>中有很多的方法来为我们实现复杂的查询与筛选操作</p><p>其中的<code>builder()</code>返回<code>NativeSearchQuery</code>，所以，在众多筛选条件之后不要忘记加上<code>builder()</code></p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717014342981.png" alt="image-20200717014342981"></p><p>基本的matchQuery查询</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">search</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//    利用构造器NativeSearchQueryBuilder构建NativeSearchQuery</span></span><br><span class="line">    NativeSearchQuery queryBuilder = <span class="keyword">new</span> NativeSearchQueryBuilder()</span><br><span class="line">            .withQuery(QueryBuilders.matchQuery(<span class="string">"title"</span>,<span class="string">"华为手机"</span>))</span><br><span class="line">            .build();</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        ElasticsearchRestTemplate.search()</span></span><br><span class="line"><span class="comment">            参数1：本机查询的构造</span></span><br><span class="line"><span class="comment">            参数2：index的类</span></span><br><span class="line"><span class="comment">            参数3：再次声明库名（可选）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SearchHits&lt;Item&gt; search = restTemplate.search(queryBuilder, Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="keyword">for</span> (SearchHit&lt;Item&gt; itemSearchHit : search) &#123;</span><br><span class="line">        System.out.println(itemSearchHit.getContent());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>NativeSearchQueryBuilder()：Spring提供的一个查询条件构造器，帮助构建json格式的请求体</p></li><li><p>QueryBuilders.matchQuery(“title”,”华为手机”)：利用QueryBuilders来生成一个查询。</p><ul><li><p>QueryBuilders：提供了大量的静态方法，用于生成各种不同类型的查询</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717021230765.png" alt="image-20200717021230765"></p></li></ul></li><li><p>SearchHit<Item>：将搜索到的数据与其他信息一起封装，包含属性：</p><ul><li>id</li><li>score：得分</li><li>sortValues：排序值</li><li>content：文档内容</li><li>highlightFields：突出显示字段</li></ul></li></ul><p>结果：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717023040336.png" alt="image-20200717023040336"></p><h3 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    NativeSearchQuery queryBuilder = <span class="keyword">new</span> NativeSearchQueryBuilder()</span><br><span class="line">            .withQuery(QueryBuilders.matchQuery(<span class="string">"title"</span>, <span class="string">"华为手机"</span>))</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">                添加分页</span></span><br><span class="line"><span class="comment">                Pageable的实现类PageRequest的of方法</span></span><br><span class="line"><span class="comment">                    参数1：当前页</span></span><br><span class="line"><span class="comment">                    参数2：要返回的页面大小，必须大于0</span></span><br><span class="line"><span class="comment">                    参数3：排序参数（可选）,Sort.Direction.DESC降序 Sort.Direction.ASC升序</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            .withPageable(PageRequest.of(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    SearchHits&lt;Item&gt; search = restTemplate.search(queryBuilder, Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="keyword">for</span> (SearchHit&lt;Item&gt; itemSearchHit : search) &#123;</span><br><span class="line">        System.out.println(itemSearchHit.getContent());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717024712082.png" alt="image-20200717024712082"></p><h3 id="排序-1"><a href="#排序-1" class="headerlink" title="排序"></a>排序</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchBySort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    NativeSearchQuery queryBuilder = <span class="keyword">new</span> NativeSearchQueryBuilder()</span><br><span class="line">            .withQuery(QueryBuilders.matchQuery(<span class="string">"title"</span>, <span class="string">"华为手机"</span>))</span><br><span class="line">            .withPageable(PageRequest.of(<span class="number">0</span>,<span class="number">4</span>))</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">                排序</span></span><br><span class="line"><span class="comment">                fieldSort(String field) 根据字段排序</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            .withSort(SortBuilders.fieldSort(<span class="string">"price"</span>).order(SortOrder.DESC))</span><br><span class="line">            .build();</span><br><span class="line">    SearchHits&lt;Item&gt; search = restTemplate.search(queryBuilder, Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="keyword">for</span> (SearchHit&lt;Item&gt; itemSearchHit : search) &#123;</span><br><span class="line">        System.out.println(itemSearchHit.getContent());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717025538195.png" alt="image-20200717025538195"></p><h2 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h2><h3 id="聚合为桶-1"><a href="#聚合为桶-1" class="headerlink" title="聚合为桶"></a>聚合为桶</h3><blockquote><p>桶即是分组，例如：按照品牌brand进行分组</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAggs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    NativeSearchQueryBuilder queryBuilder = <span class="keyword">new</span> NativeSearchQueryBuilder();</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        聚合可以用多个，所以add</span></span><br><span class="line"><span class="comment">            terms：词条聚合,传入词条名称</span></span><br><span class="line"><span class="comment">            field：聚合字段</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    NativeSearchQuery query = queryBuilder.addAggregation(AggregationBuilders.terms(<span class="string">"brands"</span>).field(<span class="string">"brand"</span>))</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">                结果集过滤，这里设置不需要结果集，不添加包含与不包含，会自动生成length为0的数组</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            .withSourceFilter(<span class="keyword">new</span> FetchSourceFilterBuilder().build())</span><br><span class="line">            .build();</span><br><span class="line">    SearchHits&lt;Item&gt; items = restTemplate.search(query, Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//        获取聚合结果集</span></span><br><span class="line">    Aggregations aggregations = items.getAggregations();</span><br><span class="line">    <span class="keyword">assert</span> aggregations != <span class="keyword">null</span>;</span><br><span class="line"><span class="comment">//        因为结果为字符串类型，所以使用ParsedStringTerms接收</span></span><br><span class="line">    ParsedStringTerms brands = aggregations.get(<span class="string">"brands"</span>);</span><br><span class="line"><span class="comment">//        获取桶</span></span><br><span class="line">    brands.getBuckets().forEach(bucket -&gt; &#123;</span><br><span class="line"><span class="comment">//            getKeyAsString()：获取桶中的key</span></span><br><span class="line"><span class="comment">//            getDocCount()：获取记录数</span></span><br><span class="line">        System.out.println(bucket.getKeyAsString() + <span class="string">"\t"</span> + bucket.getDocCount());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717230352733.png" alt="image-20200717230352733"></p><ul><li><code>AggregationBuilders</code>：聚合的构建工厂类。所有聚合都由这个工厂构建：</li></ul><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717230903011.png" alt="image-20200717230903011"></p><ul><li><p>Aggregation：聚合的结果集</p></li><li><p>ParsedStringTerms：接受聚合结果，字符串类型，ParsedTerms抽象类的子类</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200717234218525.png" alt="image-20200717234218525"></p><ul><li>ParsedLongTerms：接收数字类型</li><li>ParsedDoubleTerms：接收小数类型</li></ul></li></ul><h3 id="嵌套聚合，求平均值"><a href="#嵌套聚合，求平均值" class="headerlink" title="嵌套聚合，求平均值"></a>嵌套聚合，求平均值</h3><p>先添加数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAll2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Item&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    list.add(<span class="keyword">new</span> Item(<span class="number">5L</span>, <span class="string">"华为V30"</span>, <span class="string">"手机"</span>, <span class="string">"华为"</span>, <span class="number">3999.00</span>, <span class="string">"http://image.badcode.icu/13123.jpg"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Item(<span class="number">6L</span>, <span class="string">"华为P10"</span>, <span class="string">" 手机"</span>, <span class="string">"华为"</span>, <span class="number">2999.00</span>, <span class="string">"http://image.badcode.icu/13123.jpg"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Item(<span class="number">7L</span>, <span class="string">"小米X5"</span>, <span class="string">" 手机"</span>, <span class="string">"小米"</span>, <span class="number">1999.00</span>, <span class="string">"http://image.badcode.icu/13123.jpg"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Item(<span class="number">8L</span>, <span class="string">"iphone11"</span>, <span class="string">" 手机"</span>, <span class="string">"Apple"</span>, <span class="number">5999.00</span>, <span class="string">"http://image.badcode.icu/13123.jpg"</span>));</span><br><span class="line">    repository.saveAll(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200718000441301.png" alt="image-20200718000441301"></p><blockquote><p>根据品牌计算平均值</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSubAggs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    NativeSearchQueryBuilder queryBuilder = <span class="keyword">new</span> NativeSearchQueryBuilder();</span><br><span class="line">    NativeSearchQuery query = queryBuilder</span><br><span class="line">            .addAggregation(AggregationBuilders.terms(<span class="string">"brands"</span>).field(<span class="string">"brand"</span>)</span><br><span class="line">            .subAggregation(AggregationBuilders.avg(<span class="string">"avg_price"</span>).field(<span class="string">"price"</span>)))</span><br><span class="line">            .withSourceFilter(<span class="keyword">new</span> FetchSourceFilterBuilder().build())</span><br><span class="line">            .build();</span><br><span class="line">    SearchHits&lt;Item&gt; itemSearchHits = restTemplate.search(query, Item<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    Aggregations aggregations = itemSearchHits.getAggregations();</span><br><span class="line">    <span class="keyword">assert</span> aggregations != <span class="keyword">null</span>;</span><br><span class="line">    ParsedStringTerms brands = aggregations.get(<span class="string">"brands"</span>);</span><br><span class="line">    brands.getBuckets().forEach(bucket -&gt; &#123;</span><br><span class="line">        System.out.print(<span class="string">"品牌名："</span> + bucket.getKeyAsString() + <span class="string">"\t数量："</span> + bucket.getDocCount());</span><br><span class="line">        ParsedAvg avg_price = bucket.getAggregations().get(<span class="string">"avg_price"</span>);</span><br><span class="line">        System.out.println(<span class="string">"\t平均价格："</span> + avg_price.getValue());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/2020/07/16/image-20200718001705081.png" alt="image-20200718001705081"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
          <category> 组件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Elasticsearch </tag>
            
            <tag> Kibana </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo常用命令笔记</title>
      <link href="/posts/202007070038.html/"/>
      <url>/posts/202007070038.html/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="Hexo常用命令"><a href="#Hexo常用命令" class="headerlink" title="Hexo常用命令"></a>Hexo常用命令</h2><h3 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo clean <span class="comment"># 删除生成的文件和缓存</span></span><br><span class="line">hexo g  ==&gt; hexo generate <span class="comment"># 生成静态文件</span></span><br><span class="line">hexo d ==&gt; hexo deploy <span class="comment"># 部署到网站</span></span><br><span class="line">hexo s ==&gt; hexo server <span class="comment"># 启动服务预览</span></span><br><span class="line">hexo n <span class="string">"PostsName"</span> ==&gt; hexo new <span class="string">"PostsName"</span> <span class="comment"># 新建文章</span></span><br></pre></td></tr></table></figure><h3 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo server <span class="comment"># Hexo会监视文件变动并且自动更新，无须重启服务器</span></span><br><span class="line">hexo server s <span class="comment"># 静态模式</span></span><br><span class="line">hexo server p <span class="number">4040</span> <span class="comment"># 更改端口号</span></span><br><span class="line">hexo server <span class="literal">-i</span> <span class="number">192.168</span>.<span class="number">1.1</span> <span class="comment"># 自定义ip</span></span><br></pre></td></tr></table></figure><h3 id="监视文件变动"><a href="#监视文件变动" class="headerlink" title="监视文件变动"></a>监视文件变动</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo generate <span class="comment"># 使用Hexo生成静态文件</span></span><br><span class="line">hexo generate -<span class="literal">-watch</span> <span class="comment"># 监视文件变动</span></span><br></pre></td></tr></table></figure><h3 id="完成后部署"><a href="#完成后部署" class="headerlink" title="完成后部署"></a>完成后部署</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 两个命令的作用一样</span></span><br><span class="line">hexo generate -<span class="literal">-deploy</span></span><br><span class="line">hexo deploy -<span class="literal">-generate</span></span><br><span class="line"></span><br><span class="line">hexo deploy <span class="literal">-g</span></span><br><span class="line">hexo server <span class="literal">-g</span></span><br></pre></td></tr></table></figure><h3 id="草稿"><a href="#草稿" class="headerlink" title="草稿"></a>草稿</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo publish [<span class="type">layout</span>] &lt;title&gt;</span><br></pre></td></tr></table></figure><h3 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">"postName"</span> <span class="comment">#新建文章</span></span><br><span class="line">hexo new page <span class="string">"pageName"</span> <span class="comment">#新建页面</span></span><br><span class="line"></span><br><span class="line">hexo new photo <span class="string">"My Gallery"</span></span><br><span class="line">hexo new <span class="string">"Hello World"</span> -<span class="literal">-lang</span> tw</span><br></pre></td></tr></table></figure><h2 id="Butterfly主题使用文档"><a href="#Butterfly主题使用文档" class="headerlink" title="Butterfly主题使用文档"></a>Butterfly主题使用文档</h2><h3 id="文件头"><a href="#文件头" class="headerlink" title="文件头"></a>文件头</h3><h4 id="Page-Front-matter"><a href="#Page-Front-matter" class="headerlink" title="Page Front-matter"></a>Page Front-matter</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">type: （tags,link,categories这三个页面需要配置）</span><br><span class="line">comments: (是否需要显示评论，默认true)</span><br><span class="line">description:</span><br><span class="line">top_img: (设置顶部图)</span><br><span class="line">mathjax:</span><br><span class="line">katex:</span><br><span class="line">---</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">key</th><th align="center">value</th></tr></thead><tbody><tr><td align="center">title</td><td align="center">标题</td></tr><tr><td align="center">date</td><td align="center">日期</td></tr><tr><td align="center">updated</td><td align="center">文章更新日期</td></tr><tr><td align="center">type</td><td align="center">类型，tags,link,categories 这三个页面需要配置</td></tr><tr><td align="center">comments</td><td align="center">是否显示评论，默认 true</td></tr><tr><td align="center">description</td><td align="center">描述</td></tr><tr><td align="center">top_img</td><td align="center">顶部图</td></tr><tr><td align="center">mathjax</td><td align="center">数学公式</td></tr><tr><td align="center">katex</td><td align="center">数学公式</td></tr><tr><td align="center">aside</td><td align="center">true 表示显示右边信息卡片，默认值；false 表示不显示</td></tr><tr><td align="center">aplayer</td><td align="center">在需要的页面加载 aplayer 的 js 和 css, 请参考文章下面的音乐 配置</td></tr><tr><td align="center">highlight_shrink</td><td align="center">【可选】配置代码框是否展开 (true/false)(默认为设置中 highlight_shrink 的配置)</td></tr></tbody></table><h4 id="Post-Front-matter"><a href="#Post-Front-matter" class="headerlink" title="Post Front-matter"></a>Post Front-matter</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">tags:</span><br><span class="line">categories:</span><br><span class="line">keywords:</span><br><span class="line">description:</span><br><span class="line">top_img: （除非特定需要，可以不写）</span><br><span class="line">comments  是否显示评论（除非设置false,可以不写）</span><br><span class="line">cover:  缩略图</span><br><span class="line">toc:  是否显示toc （除非特定文章设置，可以不写）</span><br><span class="line">toc_number: 是否显示toc数字 （除非特定文章设置，可以不写）</span><br><span class="line">copyright: 是否显示版权 （除非特定文章设置，可以不写）</span><br><span class="line">mathjax:</span><br><span class="line">katex:</span><br><span class="line">hide:</span><br><span class="line">---</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">key</th><th align="center">value</th></tr></thead><tbody><tr><td align="center">title</td><td align="center">标题</td></tr><tr><td align="center">date</td><td align="center">日期</td></tr><tr><td align="center">updated</td><td align="center">文章更新日期</td></tr><tr><td align="center">tags</td><td align="center">标签</td></tr><tr><td align="center">categories</td><td align="center">分类</td></tr><tr><td align="center">keywords</td><td align="center">关键字</td></tr><tr><td align="center">type</td><td align="center">类型，tags,link,categories 这三个页面需要配置</td></tr><tr><td align="center">comments</td><td align="center">是否显示评论，默认 true</td></tr><tr><td align="center">description</td><td align="center">描述</td></tr><tr><td align="center">top_img</td><td align="center">顶部图</td></tr><tr><td align="center">cover</td><td align="center">缩略图</td></tr><tr><td align="center">toc</td><td align="center">是否显示 toc （除非特定文章设置，可以不写）</td></tr><tr><td align="center">toc_number</td><td align="center">是否显示 toc 数字 （除非特定文章设置，可以不写）</td></tr><tr><td align="center">auto_open</td><td align="center">是否自动打开 TOC (默认为设置中 toc 的 auto_open 配置)</td></tr><tr><td align="center">copyright</td><td align="center">是否显示版权 （除非特定文章设置，可以不写）</td></tr><tr><td align="center">mathjax</td><td align="center">数学公式</td></tr><tr><td align="center">katex</td><td align="center">数学公式</td></tr><tr><td align="center">hide（hidden）</td><td align="center">是否隐藏（true，false）</td></tr><tr><td align="center">sticky</td><td align="center">文章置顶，数值越大越靠前</td></tr><tr><td align="center">aside</td><td align="center">true 表示显示右边信息卡片，默认值；false 表示不显示</td></tr><tr><td align="center">aplayer</td><td align="center">在需要的页面加载 aplayer 的 js 和 css, 请参考文章下面的音乐 配置</td></tr><tr><td align="center">highlight_shrink</td><td align="center">【可选】配置代码框是否展开 (true/false)(默认为设置中 highlight_shrink 的配置)</td></tr></tbody></table><h2 id="标签外挂"><a href="#标签外挂" class="headerlink" title="标签外挂"></a>标签外挂</h2><h3 id="相册图库"><a href="#相册图库" class="headerlink" title="相册图库"></a>相册图库</h3><p>写法</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"gallery-group-main"</span>&gt;</span></span></span><br><span class="line">  &#123;% galleryGroup name description link img-url %&#125; </span><br><span class="line">  &#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">  &#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>name:  图库名字</li><li>description: 图库描述</li><li>link: 连接到对应的相册</li><li>img-url: 图库封面的图片地址</li></ul><p>示例</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"gallery-group-main"</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup '壁纸' '收藏的一些日系壁纸' '/Gallery/wallpaper' https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200706171253.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup '漫威' '关于漫威的图片' '/Gallery/marvel' https://i.loli.net/2019/12/25/8t97aVlp4hgyBGu.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup 'OH MY GIRL' '关于OH MY GIRL的图片' '/Gallery/ohmygirl' https://i.loli.net/2019/12/25/hOqbQ3BIwa6KWpo.jpg %&#125;</span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/159409158.jpg" alt=""></p><h3 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h3><p>用法</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown 图片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><h3 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h3><p>用法：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [class] [no-icon] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">[class]   : default | primary | success | info | warning | danger.</span><br><span class="line">[no-icon] : Disable icon in note.</span><br><span class="line"></span><br><span class="line">All parameters are optional.</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"note default icon"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span>default<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#123;% note default icon %&#125;</span><br><span class="line">default</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"note primary icon"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span>primary<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#123;% note primary icon %&#125;</span><br><span class="line">primary</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"note success icon"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span>success<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#123;% note success icon %&#125;</span><br><span class="line">success</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"note info icon"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span>info<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#123;% note info icon %&#125;</span><br><span class="line">info</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"note warning icon"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span>warning<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#123;% note warning icon %&#125;</span><br><span class="line">warning</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"note danger icon"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span>danger<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#123;% note danger icon %&#125;</span><br><span class="line">danger</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"note no-icon"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span>primary<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#123;% note no-icon%&#125;</span><br><span class="line">无icon</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note default icon"><p>default</p></div><div class="note primary icon"><p>primary</p></div><div class="note success icon"><p>success</p></div><div class="note info icon"><p>info</p></div><div class="note warning icon"><p>warning</p></div><div class="note danger icon"><p>danger</p></div><div class="note no-icon"><p>null icon</p></div><h3 id="自定义图标及颜色"><a href="#自定义图标及颜色" class="headerlink" title="自定义图标及颜色"></a>自定义图标及颜色</h3><h4 id="阿里图标"><a href="#阿里图标" class="headerlink" title="阿里图标"></a>阿里图标</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">/* default */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon custom iconfont iconqq"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #f7f7f7;border-left-color: #777;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>default<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* success */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon custom iconfont iconqq"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #eff8f0;border-left-color: #5cb85c;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>success<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* primary */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon custom iconfont iconqq"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #f5f0fa;border-left-color: #6f42c1;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>primary<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* info */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon custom iconfont .icon-QQ"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #eef7fa;border-left-color: #428bca;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>info<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* warning */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon custom iconfont .icon-QQ"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #fdf8ea;border-left-color: #f0ad4e;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>warning<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* danger */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon custom iconfont .icon-QQ"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #fcf1f2;border-left-color: #d9534f;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>danger<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">genghao</span><br></pre></td></tr></table></figure><div  class="note icon custom iconfont .icon-QQ"  style="background: #f7f7f7;border-left-color: #777;">  <p>default</p></div><div  class="note icon custom iconfont .icon-QQ1"  style="background: #eff8f0;border-left-color: #5cb85c;">  <p>success</p></div><div  class="note icon custom iconfont .icon-QQ2"  style="background: #f5f0fa;border-left-color: #6f42c1;">  <p>primary</p></div><div  class="note icon custom iconfont .icon-qq"  style="background: #eef7fa;border-left-color: #428bca;">  <p>info</p></div><div  class="note icon custom iconfont iconqq"  style="background: #fdf8ea;border-left-color: #f0ad4e;">  <p>warning</p></div><div  class="note icon custom iconfont iconqq"  style="background: #fcf1f2;border-left-color: #d9534f;">  <p>danger</p></div><div class="note icon custom iconfont .icon-qq1" style="background:#f7f7f7;border-left-color:#777;--icon-color: red;"><p>QQ 图标</p></div><h4 id="fontawesome5图标"><a href="#fontawesome5图标" class="headerlink" title="fontawesome5图标"></a>fontawesome5图标</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">/* 链接 */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon font5 fa-fw fa fa-link"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #eef7fa;border-left-color: #428bca;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>info<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* 小喇叭 */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon font5 fas fa-bullhorn"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #fcf1f2;border-left-color: #d9534f;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>info<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* BUG */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon font5 fas fa-bug"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #fcf1f2;border-left-color: #d9534f;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>info<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* idea */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"note icon font5 far fa-lightbulb"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background: #fdf8ea;border-left-color: #f0ad4e;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>info<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div  class="note icon font5 fa-fw fa fa-link"  style="background: #eef7fa;border-left-color: #428bca;">  <p>info</p></div><div  class="note icon font5 fas fa-bullhorn"  style="background: #fcf1f2;border-left-color: #d9534f;">  <p>info</p></div><div  class="note icon font5 fas fa-bug"  style="background: #fcf1f2;border-left-color: #d9534f;">  <p>info</p></div><div  class="note icon font5 far fa-lightbulb"  style="background: #fdf8ea;border-left-color: #f0ad4e;">  <p>info</p></div><h3 id="自定义小标签"><a href="#自定义小标签" class="headerlink" title="自定义小标签"></a>自定义小标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote red"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>默认red<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote quote"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>quote<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote info"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>info<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote done"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>done<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote success"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>success<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote danger"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>danger<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote error"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>error<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote radiation"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>radiation<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote bug"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>bug<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote idea yellow"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>idea-yellow<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote link blue"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>link- blue<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote paperclip"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>paperclip<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote todo"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>todo<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote msg cyan"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>msg cyan<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote guide"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>guide<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote download"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>download<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote up"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>up<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote undo"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>undo<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">/* 引用 */</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"snote quote"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">'p subtitle'</span>&gt;</span>小标题<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">这是个引用</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="snote red"><p>默认red</p></div><div class="snote quote"><p>quote</p></div><div class="snote info"><p>info</p></div><div class="snote done"><p>done</p></div><div class="snote success"><p>success</p></div><div class="snote danger"><p>danger</p></div><div class="snote error"><p>error</p></div><div class="snote radiation"><p>radiation</p></div><div class="snote bug"><p>bug</p></div><div class="snote idea yellow"><p>idea-yellow</p></div><div class="snote link blue"><p>link- blue</p></div><div class="snote paperclip"><p>paperclip</p></div><div class="snote todo"><p>todo</p></div><div class="snote msg cyan"><p>msg cyan</p></div><div class="snote guide"><p>guide</p></div><div class="snote download"><p>download</p></div><div class="snote up"><p>up</p></div><div class="snote undo"><p>undo</p></div><div class="snote quote"><p class='p subtitle'>引用框--标题</p>引用内容</div><p>关于颜色及标记控制</p><ul><li><p>彩色图标</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">quote, info, warning, done&#x2F;success, error&#x2F;danger</span><br><span class="line"></span><br><span class="line">quote     蓝色引号</span><br><span class="line">info  蓝色叹号</span><br><span class="line">warning   黄色叹号</span><br><span class="line">done      绿色打钩</span><br><span class="line">success   绿色打钩</span><br><span class="line">error     红色禁止</span><br><span class="line">danger    红色打叉</span><br></pre></td></tr></table></figure></li><li><p>灰色图标</p><p>也可以指定颜色</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">radiation, bug, idea, link, paperclip, todo, msg, guide, download, up, undo</span><br><span class="line"></span><br><span class="line">radiation核标记</span><br><span class="line">bug    爬虫</span><br><span class="line">idea        电灯泡</span><br><span class="line">link        锁链</span><br><span class="line">paperclip   回形针</span><br><span class="line">todo        勾选框</span><br><span class="line">msg         向右箭头</span><br><span class="line">guide       指路牌</span><br><span class="line">download    下载标记</span><br><span class="line">up          上传标记</span><br><span class="line">undo        回转箭头标记</span><br></pre></td></tr></table></figure><ul><li><p>颜色</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clear, light, gray, red, yellow, green, cyan, blue</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="渐变背景标签"><a href="#渐变背景标签" class="headerlink" title="渐变背景标签"></a>渐变背景标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'tip'</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>默认情况<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'tip info'</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>info<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'tip success'</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>success<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'tip error'</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>error<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'tip warning'</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>warning<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'tip font5 fas fa-atom'</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>自定义font5图标<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'tip custom icon-QQ2'</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>自定义iconfont图标<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip wtgo font5 fas fa-bolt"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>文字<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip ban font5 fas fa-ban"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>文字<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip home font5 fas fa-home"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>文字<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip important font5 fas fa-home"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>魔改标签4<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip ref font5 fas fa-sync"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>魔改标签5<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip ffa font5 fas fa-cogs"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>魔改标签6<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip key font5 fas fa-key"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>魔改标签7<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip socd font5 fas fa-bell"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>魔改标签8<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tip qq font5 fab fa-qq"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>魔改标签9<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class='tip'><p>默认情况<p></div><div class='tip info'><p>info<p></div><div class='tip success'><p>success<p></div><div class='tip error'><p>error<p></div><div class='tip warning'><p>warning<p></div><div class='tip font5 fas fa-atom'><p>自定义font5图标<p></div><div class='tip custom icon-QQ2'><p>自定义iconfont图标<p></div><div class="tip wtgo font5 fas fa-bolt"><p>文字</p><p></p></div><div class="tip ban font5 fas fa-ban"><p>文字</p><p></p></div><div class="tip home font5 fas fa-home"><p>文字</p><p></p></div><div class="tip important font5 fas fa-home"><p>魔改标签4</p><p></p></div><div class="tip ref font5 fas fa-sync"><p>魔改标签5</p><p></p></div><div class="tip ffa font5 fas fa-cogs"><p>魔改标签6</p><p></p></div><div class="tip key font5 fas fa-key"><p>魔改标签7</p><p></p></div><div class="tip socd font5 fas fa-bell"><p>魔改标签8</p><p></p></div><div class="tip qq font5 fab fa-qq"><p>魔改标签9</p><p></p></div><h3 id="小标签和边框颜色"><a href="#小标签和边框颜色" class="headerlink" title="小标签和边框颜色"></a>小标签和边框颜色</h3><h4 id="小标签"><a href="#小标签" class="headerlink" title="小标签"></a>小标签</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inline-tag [red|green|blue|yellow|grey]"</span>&gt;</span>语法<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inline-tag red"</span>&gt;</span>红色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inline-tag green"</span>&gt;</span>绿色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inline-tag blue"</span>&gt;</span>蓝色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inline-tag yellow"</span>&gt;</span>黄色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inline-tag grey"</span>&gt;</span>灰色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--自定义颜色--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inline-tag"</span> <span class="attr">style</span>=<span class="string">"--Color:#881B12"</span>&gt;</span>自定义颜色小标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p><span class="inline-tag red">红色小标签</span> <span class="inline-tag green">绿色小标签</span> <span class="inline-tag blue">蓝色小标签</span> <span class="inline-tag yellow">黄色小标签</span> <span class="inline-tag grey">灰色小标签</span></p><h4 id="边框颜色"><a href="#边框颜色" class="headerlink" title="边框颜色"></a>边框颜色</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border [left|right|top|bottom] [red|green|blue|yellow|grey]"</span>&gt;</span></span><br><span class="line">  语法</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border top red"</span>&gt;</span>上边框<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border right red"</span>&gt;</span>右边框<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border bottom red"</span>&gt;</span>下边框<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border left red"</span>&gt;</span>左边框<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--自定义颜色--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border left style="</span><span class="attr">--Color:</span>#<span class="attr">881B12</span>""&gt;</span>左边框<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p class="div-border top red">上边框</p><p class="div-border right red">右边框</p><p class="div-border bottom red">下边框</p><p class="div-border left red">左边框</p><p>预设颜色分别为 <code>red</code>、<code>green</code>、<code>blue</code>、<code>yellow</code>、<code>grey</code> 也就是小标签的五种颜色</p><h3 id="全边框和自定义颜色"><a href="#全边框和自定义颜色" class="headerlink" title="全边框和自定义颜色"></a>全边框和自定义颜色</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">"div-border"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background-color: rgba(82,196,26,.1);border: 1px solid #52c41a;border-radius: 0.4rem;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  全边框</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">/* 或者如下写法 */</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"background-color: rgba(82,196,26,.1);border: 1px solid #52c41a;border-radius: 0.4rem;display: block;padding: 10px;"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  全边框</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">/* 内置样式 */</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border green"</span>&gt;</span>绿色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border red"</span>&gt;</span>红色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border yellow"</span>&gt;</span>黄色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border grey"</span>&gt;</span>灰色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"div-border blue"</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p  style="background-color: rgba(82,196,26,.1);border: 1px solid #52c41a;border-radius: 0.4rem;display: block;padding: 10px;">  全边框</p><p class="div-border green">绿色</p><p class="div-border red">红色</p><p class="div-border yellow">黄色</p><p class="div-border grey">灰色</p><p class="div-border blue">蓝色</p><h3 id="隐藏内容"><a href="#隐藏内容" class="headerlink" title="隐藏内容"></a>隐藏内容</h3><p>隐藏一些内容，需要点击才能插看</p><p><code>inline</code> 在文本里面添加按钮隐藏内容，只限文字</p><p>( content 不能包含当引号，可用 <code>&#39;</code>)</p><p><code>block</code> 独立的 block 隐藏内容，可以隐藏很多内容，包括图片，` 代码块等等</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideInline content,display,bg,color %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><ul><li>content: 文本内容</li><li>display: 按钮显示的文字 (可选)</li><li>bg: 按钮的背景颜色 (可选)</li><li>color: 按钮文字的颜色 (可选)</li></ul><p>示例</p><p>隐藏 inline 内容 <span class="hide-inline"><button class="hide-button button--animated" style="">按钮显示的文字  </button><span class="hide-content">这是隐藏内容</span></span></p><p>隐藏 block 内容</p><div class="hide-block"><button class="hide-button button--animated" style="">这是隐藏内容    </button><span class="hide-content"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWord</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"HelloWord"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span></div><h3 id="hideToggle"><a href="#hideToggle" class="headerlink" title="hideToggle"></a>hideToggle</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!--markdown写法--&gt;</span></span></span><br><span class="line">&#123;% hideToggle display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideToggle %&#125;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--html写法--&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hide-toggle"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hide-button toggle-title"</span> <span class="attr">style</span>=<span class="string">""</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-caret-right fa-fw"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span>文字<span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hide-content"</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span>默认效果<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>content: 文本内容</li><li>display: 显示的文字 (可选)</li><li>bg: 背景颜色 (可选)</li><li>color: 文字的颜色 (可选)</li></ul><div class="hide-toggle" ><div class="hide-button toggle-title" style=""><i class="fas fa-caret-right fa-fw"></i><span>显示文本</span></div>    <div class="hide-content"><div class="hide-toggle"><div class="hide-button toggle-title" style=""><i class="fa fa-caret-right fa-fw"></i><span>文字</span></div><div class="hide-content"><p>html默认效果</p></div></div></div></div><h3 id="mermaid"><a href="#mermaid" class="headerlink" title="mermaid"></a>mermaid</h3><p>使用 mermaid 标签可以绘制 Flowchart（流程图）、Sequence diagram（时序图 ）、Class Diagram（类别图）、State Diagram（状态图）、Gantt（甘特图）和 Pie Chart（圆形图），具体可以查看 <a href="https://mermaid-js.github.io/mermaid/#/" target="_blank" rel="noopener">mermaid 文档</a></p><p>写法</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><p>示例</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mermaid %&#125;</span><br><span class="line">pie</span><br><span class="line">title Key elements in Product X</span><br><span class="line">"Calcium" : 42.96</span><br><span class="line">"Potassium" : 50.05</span><br><span class="line">"Magnesium" : 10.01</span><br><span class="line">"Iron" : 5</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure><div class="mermaid">          pietitle 掌握技能饼图"HTML" : 42.96"Java" : 50.05"MySQL" : 10.01"Python" : 5          </div><h3 id="Checkbox-amp-Radio"><a href="#Checkbox-amp-Radio" class="headerlink" title="Checkbox &amp; Radio"></a>Checkbox &amp; Radio</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure><p>参数列表</p><ul><li><p>颜色</p><p><code>red, yellow, green, cyan, blue</code></p></li><li><p>样式</p><p><code>plus, minus, times</code></p></li><li><p>选中状态</p><p><code>checked</code></p></li></ul><p>tag标签格式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 纯文本测试 %&#125;</span><br><span class="line">&#123;% checkbox checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% checkbox red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% checkbox green checked, 绿色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, 黄色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, 青色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox blue checked, 蓝色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, 增加 %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, 减少 %&#125;</span><br><span class="line">&#123;% checkbox times red checked, 叉 %&#125;</span><br><span class="line">&#123;% radio 纯文本测试 %&#125;</span><br><span class="line">&#123;% radio checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% radio red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% radio green, 绿色 %&#125;</span><br><span class="line">&#123;% radio yellow, 黄色 %&#125;</span><br><span class="line">&#123;% radio cyan, 青色 %&#125;</span><br><span class="line">&#123;% radio blue, 蓝色 %&#125;</span><br></pre></td></tr></table></figure><p>html标签格式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>纯文本测试<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    支持简单的</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">"https://guides.github.com/features/mastering-markdown/"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">target</span>=<span class="string">"_blank"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">"noopener"</span></span></span><br><span class="line"><span class="tag">      &gt;</span>markdown<span class="tag">&lt;/<span class="name">a</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">    语法</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox red"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>支持自定义颜色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox green checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>绿色 + 默认选中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox yellow checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>黄色 + 默认选中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox cyan checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>青色 + 默认选中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox blue checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>蓝色 + 默认选中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox plus green checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>增加<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox minus yellow checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>减少<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox times red checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>叉<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>纯文本测试<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox checked"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">checked</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    支持简单的</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">"https://guides.github.com/features/mastering-markdown/"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">target</span>=<span class="string">"_blank"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">"noopener"</span></span></span><br><span class="line"><span class="tag">      &gt;</span>markdown<span class="tag">&lt;/<span class="name">a</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">    语法</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox red"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>支持自定义颜色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox green"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>绿色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox yellow"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>黄色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox cyan"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>青色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox blue"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="checkbox">  <input type="checkbox" />  <p>纯文本测试</p></div><div class="checkbox checked">  <input type="checkbox" checked />  <p>    支持简单的    <a      href="https://guides.github.com/features/mastering-markdown/"      target="_blank"      rel="noopener"      >markdown</a    >    语法  </p></div><div class="checkbox red">  <input type="checkbox" />  <p>支持自定义颜色</p></div><div class="checkbox green checked">  <input type="checkbox" checked />  <p>绿色 + 默认选中</p></div><div class="checkbox yellow checked">  <input type="checkbox" checked />  <p>黄色 + 默认选中</p></div><div class="checkbox cyan checked">  <input type="checkbox" checked />  <p>青色 + 默认选中</p></div><div class="checkbox blue checked">  <input type="checkbox" checked />  <p>蓝色 + 默认选中</p></div><div class="checkbox plus green checked">  <input type="checkbox" checked />  <p>增加</p></div><div class="checkbox minus yellow checked">  <input type="checkbox" checked />  <p>减少</p></div><div class="checkbox times red checked">  <input type="checkbox" checked />  <p>叉</p></div><div class="checkbox">  <input type="radio" />  <p>纯文本测试</p></div><div class="checkbox checked">  <input type="radio" checked />  <p>    支持简单的    <a      href="https://guides.github.com/features/mastering-markdown/"      target="_blank"      rel="noopener"      >markdown</a    >    语法  </p></div><div class="checkbox red">  <input type="radio" />  <p>支持自定义颜色</p></div><div class="checkbox green">  <input type="radio" />  <p>绿色</p></div><div class="checkbox yellow">  <input type="radio" />  <p>黄色</p></div><div class="checkbox cyan">  <input type="radio" />  <p>青色</p></div><div class="checkbox blue">  <input type="radio" />  <p>蓝色</p></div><h3 id="按钮"><a href="#按钮" class="headerlink" title="按钮"></a>按钮</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn [url],[text],[icon],[color] [style] [layout] [position] [size] %&#125;</span><br><span class="line"></span><br><span class="line">[url]         : 链接</span><br><span class="line">[text]        : 按钮文字</span><br><span class="line">[icon]        : [可选] 图标</span><br><span class="line">[color]       : [可选] 按钮背景顔色(默认style时）</span><br><span class="line"><span class="code">                      按钮字体和边框顔色(outline时)</span></span><br><span class="line"><span class="code">                      default/blue/pink/red/purple/orange/green</span></span><br><span class="line">[style]       : [可选] 按钮样式 默认实心</span><br><span class="line"><span class="code">                      outline/留空</span></span><br><span class="line">[layout]      : [可选] 按钮佈局 默认为line</span><br><span class="line"><span class="code">                      block/留空</span></span><br><span class="line">[position]    : [可选] 按钮位置 前提是设置了layout为block 默认为左边</span><br><span class="line"><span class="code">                      center/right/留空</span></span><br><span class="line">[size]        : [可选] 按钮大小</span><br><span class="line"><span class="code">                      larger/留空</span></span><br></pre></td></tr></table></figure><h4 id="demo-1"><a href="#demo-1" class="headerlink" title="demo 1"></a>demo 1</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This is my website, click the button &#123;% btn 'https://blog.badcode.icu',BadCode's Blog %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn 'https://blog.badcode.icu',BadCode's Blog,,outline %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,outline %&#125;</span><br><span class="line">This is my website, click the button &#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,larger %&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-beautify button--animated "</span> <span class="attr">href</span>=<span class="string">"https://blog.badcode.icu"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"noopener"</span> <span class="attr">title</span>=<span class="string">"BadCode's Blog"</span>&gt;</span>BadCode's Blog <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-beautify button--animated "</span> <span class="attr">href</span>=<span class="string">"https://blog.badcode.icu"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"noopener"</span> <span class="attr">title</span>=<span class="string">"BadCode's Blog"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"far fa-hand-point-right fa-fw"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> BadCode's Blog <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-beautify button--animated outline"</span> <span class="attr">href</span>=<span class="string">"https://blog.badcode.icu"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"noopener"</span> <span class="attr">title</span>=<span class="string">"BadCode's Blog"</span>&gt;</span>BadCode's Blog <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-beautify button--animated outline"</span> <span class="attr">href</span>=<span class="string">"https://blog.badcode.icu"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"noopener"</span> <span class="attr">title</span>=<span class="string">"BadCode's Blog"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"far fa-hand-point-right fa-fw"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> BadCode's Blog <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-beautify button--animated larger"</span> <span class="attr">href</span>=<span class="string">"https://blog.badcode.icu"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"noopener"</span> <span class="attr">title</span>=<span class="string">"BadCode's Blog"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"far fa-hand-point-right fa-fw"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> BadCode's Blog <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a class="btn-beautify button--animated " href="https://blog.badcode.icu" target="_blank" rel="noopener" title="BadCode's Blog">BadCode’s Blog </a></p><p><a class="btn-beautify button--animated " href="https://blog.badcode.icu" target="_blank" rel="noopener" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode’s Blog </a></p><p><a class="btn-beautify button--animated outline" href="https://blog.badcode.icu" target="_blank" rel="noopener" title="BadCode's Blog">BadCode’s Blog </a></p><p><a class="btn-beautify button--animated outline" href="https://blog.badcode.icu" target="_blank" rel="noopener" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode’s Blog </a></p><p><a class="btn-beautify button--animated larger" href="https://blog.badcode.icu" target="_blank" rel="noopener" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode’s Blog </a></p><h4 id="demo-2"><a href="#demo-2" class="headerlink" title="demo 2"></a>demo 2</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,block %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,block center larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,block right outline larger %&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-beautify button--animated block"</span> <span class="attr">href</span>=<span class="string">"https://blog.badcode.icu"</span> <span class="attr">title</span>=<span class="string">"BadCode's Blog"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"far fa-hand-point-right fa-fw"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> BadCode's Blog <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-beautify button--animated block center larger"</span> <span class="attr">href</span>=<span class="string">"https://blog.badcode.icu"</span> <span class="attr">title</span>=<span class="string">"BadCode's Blog"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"far fa-hand-point-right fa-fw"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> BadCode's Blog <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn-beautify button--animated block right outline larger"</span> <span class="attr">href</span>=<span class="string">"https://blog.badcode.icu"</span> <span class="attr">title</span>=<span class="string">"BadCode's Blog"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"far fa-hand-point-right fa-fw"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> BadCode's Blog <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a class="btn-beautify button--animated block" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode’s Blog </a></p><p><a class="btn-beautify button--animated block center larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode’s Blog </a></p><p><a class="btn-beautify button--animated block right outline larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode’s Blog </a></p><h4 id="demo-3"><a href="#demo-3" class="headerlink" title="demo 3"></a>demo 3</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,blue larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,pink larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,red larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,purple larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,orange larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,green larger %&#125;</span><br></pre></td></tr></table></figure><a class="btn-beautify button--animated larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated blue larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated pink larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated red larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated purple larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated orange larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated green larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><h4 id="demo-4"><a href="#demo-4" class="headerlink" title="demo 4"></a>demo 4</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn-center"</span>&gt;</span></span></span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,outline larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,outline blue larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,outline pink larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,outline red larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,outline purple larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,outline orange larger %&#125;</span><br><span class="line">&#123;% btn 'https://blog.badcode.icu',BadCode's Blog,far fa-hand-point-right,outline green larger %&#125;</span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><div class="btn-center"><a class="btn-beautify button--animated outline larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated outline blue larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated outline pink larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated outline red larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated outline purple larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated outline orange larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a><a class="btn-beautify button--animated outline green larger" href="https://blog.badcode.icu" title="BadCode's Blog"><i class="far fa-hand-point-right fa-fw"></i> BadCode's Blog </a></div><h3 id="富文本按钮"><a href="#富文本按钮" class="headerlink" title="富文本按钮"></a>富文本按钮</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns 样式参数 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>参数列表</p><ul><li><p>圆角样式</p><p><code>rounded, circle</code></p></li><li><p>布局方式</p><p>默认为自动宽度，适合视野内只有一两个的情况。</p><table><thead><tr><th align="center">参数</th><th align="center">含义</th></tr></thead><tbody><tr><td align="center">wide</td><td align="center">宽一点的按钮</td></tr><tr><td align="center">fill</td><td align="center">填充布局，自动铺满至少一行，多了会换行。</td></tr><tr><td align="center">center</td><td align="center">居中，按钮之间是固定间距。</td></tr><tr><td align="center">around</td><td align="center">居中分散</td></tr><tr><td align="center">grid2</td><td align="center">等宽最多 2 列，屏幕变窄会适当减少列数。</td></tr><tr><td align="center">grid3</td><td align="center">等宽最多 3 列，屏幕变窄会适当减少列数。</td></tr><tr><td align="center">grid4</td><td align="center">等宽最多 4 列，屏幕变窄会适当减少列数。</td></tr><tr><td align="center">grid5</td><td align="center">等宽最多 5 列，屏幕变窄会适当减少列数。</td></tr></tbody></table></li><li><p>增加文字样式</p><p>可以在容器内增加 <code>标题</code> 和 <code>描述文字</code></p></li></ul><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell BadCode's Blog, https://blog.badcode.icu, https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/avatar.jpg %&#125;</span><br><span class="line">&#123;% cell BadCode's Blog, https://blog.badcode.icu, https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/avatar.jpg %&#125;</span><br><span class="line">&#123;% cell BadCode's Blog, https://blog.badcode.icu, https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/avatar.jpg %&#125;</span><br><span class="line">&#123;% cell BadCode's Blog, https://blog.badcode.icu, https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/avatar.jpg %&#125;</span><br><span class="line">&#123;% cell BadCode's Blog, https://blog.badcode.icu, https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/avatar.jpg %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell 下载源码, /, fa fa-download %&#125;</span><br><span class="line">&#123;% cell 查看文档, /, fa fa-book %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">'https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">'fa fa-apple'</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">&#123;% p red, 专业版 %&#125;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_pro.png'</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">'https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">'fa fa-apple'</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">&#123;% p green, 免费版 %&#125;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_lite.png'</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><div class="btns circle grid5">            <a href='https://blog.badcode.icu' title='BadCode's Blog'><img src= "/img/loading.gif" data-src='https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200706095911.jpg'>BadCode's Blog</a><a href='https://blog.badcode.icu' title='BadCode's Blog'><img src= "/img/loading.gif" data-src='https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200706095911.jpg'>BadCode's Blog</a><a href='https://blog.badcode.icu' title='BadCode's Blog'><img src= "/img/loading.gif" data-src='https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200706095911.jpg'>BadCode's Blog</a><a href='https://blog.badcode.icu' title='BadCode's Blog'><img src= "/img/loading.gif" data-src='https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200706095911.jpg'>BadCode's Blog</a><a href='https://blog.badcode.icu' title='BadCode's Blog'><img src= "/img/loading.gif" data-src='https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200706095911.jpg'>BadCode's Blog</a>          </div><div class="btns rounded grid5">            <a href='/' title='下载源码'><i class='fa fa-download'></i>下载源码</a><a href='/' title='查看文档'><i class='fa fa-book'></i>查看文档</a>          </div><div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1' target="_blank" rel="noopener"><i class='fa fa-apple'></i><b>心率管家</b><p class='p red'>专业版</p><img src= "/img/loading.gif" data-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1' target="_blank" rel="noopener"><i class='fa fa-apple'></i><b>心率管家</b><p class='p green'>免费版</p><img src= "/img/loading.gif" data-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_lite.png'></a>          </div><h3 id="Tab"><a href="#Tab" class="headerlink" title="Tab"></a>Tab</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab [Tab caption] [@icon] --&gt;</span></span></span><br><span class="line">Any content (support inline tags too).</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line">&#123;% endtabs %&#125;</span><br><span class="line"></span><br><span class="line">Unique name   : Unique name of tabs block tag without comma.</span><br><span class="line"><span class="code">                Will be used in #id's as prefix for each tab with their index numbers.</span></span><br><span class="line"><span class="code">                If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes.</span></span><br><span class="line"><span class="code">                Only for current url of post/page must be unique!</span></span><br><span class="line">[index]       : Index number of active tab.</span><br><span class="line"><span class="code">                If not specified, first tab (1) will be selected.</span></span><br><span class="line"><span class="code">                If index is -1, no tab will be selected. It's will be something like spoiler.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line">[Tab caption] : Caption of current tab.</span><br><span class="line"><span class="code">                If not caption specified, unique name with tab index suffix will be used as caption of tab.</span></span><br><span class="line"><span class="code">                If not caption specified, but specified icon, caption will empty.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br><span class="line">[@icon]       : FontAwesome icon name (full-name, look like 'fas fa-font')</span><br><span class="line"><span class="code">                Can be specified with or without space; e.g. 'Tab caption @icon' similar to 'Tab caption@icon'.</span></span><br><span class="line"><span class="code">                Optional parameter.</span></span><br></pre></td></tr></table></figure><ul><li><p>tab-id</p><p>必填，如果一个页面有多个 tabs 时，tab-id 不能重复。</p></li><li><p>tab-name</p><p>标签文本。</p></li></ul><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button data-href="#test1-1">test1 1</button></li><li class="tab"><button data-href="#test1-2">test1 2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200706171316.jpeg" alt=""></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p>这里面写内容，支持的语法格式有限，请尽量不要写太过复杂的东西。</p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="预设方案1：默认选择第一个"><a href="#预设方案1：默认选择第一个" class="headerlink" title="预设方案1：默认选择第一个"></a>预设方案1：默认选择第一个</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button data-href="#test1-1">test1 1</button></li><li class="tab"><button data-href="#test1-2">test1 2</button></li><li class="tab"><button data-href="#test1-3">test1 3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><strong>This is Tab 1.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p><strong>This is Tab 2.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>This is Tab 3.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="预设方案2：预设选择tabs"><a href="#预设方案2：预设选择tabs" class="headerlink" title="预设方案2：预设选择tabs"></a>预设方案2：预设选择tabs</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab"><button data-href="#test2-1">test2 1</button></li><li class="tab"><button data-href="#test2-2">test2 2</button></li><li class="tab active"><button data-href="#test2-3">test2 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test2-1"><p><strong>This is Tab 1.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><strong>This is Tab 2.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test2-3"><p><strong>This is Tab 3.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="预设方案3：没有预设值"><a href="#预设方案3：没有预设值" class="headerlink" title="预设方案3：没有预设值"></a>预设方案3：没有预设值</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="test3"><ul class="nav-tabs"><li class="tab"><button data-href="#test3-1">test3 1</button></li><li class="tab"><button data-href="#test3-2">test3 2</button></li><li class="tab"><button data-href="#test3-3">test3 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test3-1"><p><strong>This is Tab 1.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-2"><p><strong>This is Tab 2.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-3"><p><strong>This is Tab 3.</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="预设方案4：自定义tab名"><a href="#预设方案4：自定义tab名" class="headerlink" title="预设方案4：自定义tab名"></a>预设方案4：自定义tab名</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab 第一个Tab --&gt;</span></span></span><br><span class="line"><span class="strong">**tab名字为第一个Tab**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab @fab fa-apple-pay --&gt;</span></span></span><br><span class="line"><span class="strong">**只有图标 没有Tab名字**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab 炸弹@fas fa-bomb --&gt;</span></span></span><br><span class="line"><span class="strong">**名字+icon**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button data-href="#test4-1">第一个Tab</button></li><li class="tab"><button data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button data-href="#test4-3"><i class="fas fa-bomb"></i>炸弹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tab名字为第一个Tab</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>只有图标 没有Tab名字</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>名字+icon</strong></p><button class="tab-to-top" onclick="scrollToDest($(this).parents('.tabs'),65)"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="Folding"><a href="#Folding" class="headerlink" title="Folding"></a>Folding</h3><p>markdown语法</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 参数（可选）, 标题 %&#125;</span><br><span class="line"></span><br><span class="line">![](https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/11/da1fc8df33522db88a79b935010a5706.png)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><p>html语法</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">details</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">summary</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>查看图片测试<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">summary</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/img/loading.gif</span></span></span><br><span class="line"><span class="tag">      <span class="attr">data-src</span>=<span class="string">"https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/11/da1fc8df33522db88a79b935010a5706.png"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">details</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">cyan</span> <span class="attr">open</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">summary</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>查看默认打开的折叠框<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">summary</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个默认打开的折叠框。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">details</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">green</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">summary</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>查看代码测试<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">summary</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">details</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">yellow</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">summary</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>查看列表测试<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">summary</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>haha<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>hehe<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">details</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">red</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">summary</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>查看嵌套测试<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">summary</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">details</span> <span class="attr">blue</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">summary</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>查看嵌套测试2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">summary</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">details</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">summary</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>查看嵌套测试3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">summary</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">              hahaha</span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                &gt;</span><span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">                <span class="attr">src</span>=<span class="string">https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/img/loading.gif</span></span></span><br><span class="line"><span class="tag">                <span class="attr">data-src</span>=<span class="string">'https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/emoji/tieba/%E6%BB%91%E7%A8%BD.png'</span></span></span><br><span class="line"><span class="tag">                <span class="attr">style</span>=<span class="string">'height:24px'</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">details</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">details</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">details</span>&gt;</span></span><br></pre></td></tr></table></figure><p>参数位置可以填写颜色和状态，多个参数用空格隔开。</p><ul><li><p>颜色</p><p><code>blue, cyan, green, yellow, red</code></p></li><li><p>状态</p><p>状态填写 <code>open</code> 代表默认打开。</p></li></ul><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 查看图片测试 %&#125;</span><br><span class="line"></span><br><span class="line">![](https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/11/da1fc8df33522db88a79b935010a5706.png)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, 查看默认打开的折叠框 %&#125;</span><br><span class="line"></span><br><span class="line">这是一个默认打开的折叠框。</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, 查看代码测试 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, 查看列表测试 %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">- </span>haha</span><br><span class="line"><span class="bullet">- </span>hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, 查看嵌套测试 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, 查看嵌套测试2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding 查看嵌套测试3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha <span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/emoji/tieba/%E6%BB%91%E7%A8%BD.png'</span> <span class="attr">style</span>=<span class="string">'height:24px'</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><details ><summary> <p>查看图片测试</p> </summary>              <div class='content'>              <p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/11/da1fc8df33522db88a79b935010a5706.png" alt=""></p>              </div>            </details><details cyan open><summary> <p>查看默认打开的折叠框</p> </summary>              <div class='content'>              <p>这是一个默认打开的折叠框。</p>              </div>            </details><details green><summary> <p>查看代码测试</p> </summary>              <div class='content'>                            </div>            </details><details yellow><summary> <p>查看列表测试</p> </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details red><summary> <p>查看嵌套测试</p> </summary>              <div class='content'>              <details blue><summary> <p>查看嵌套测试2</p> </summary>              <div class='content'>              <details ><summary> <p>查看嵌套测试3</p> </summary>              <div class='content'>              <p>hahaha <span><img src= "/img/loading.gif" data-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details><h3 id="Fancybox"><a href="#Fancybox" class="headerlink" title="Fancybox"></a>Fancybox</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% fancybox 参数, 列数 %&#125;</span><br><span class="line">![<span class="string">图片描述</span>](<span class="link">https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg</span>)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg)</span><br><span class="line">&#123;% endfancybox %&#125;</span><br></pre></td></tr></table></figure><ul><li><p>对齐方向</p><p><code>left</code>, <code>center</code>, <code>right</code></p></li><li><p>缩放</p><p><code>stretch</code></p></li><li><p>列数</p><p>逗号后面直接写列数，支持 2 ～ 8 列。设定列列数之后就是「多行多图」布局，此时图片默认左对齐。为了避免图片大小不一，建议搭配 <code>stretch</code> 来时图片放大填充。</p></li></ul><h4 id="单张图片"><a href="#单张图片" class="headerlink" title="单张图片"></a>单张图片</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"gallery "</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"fancybox"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">alt</span>=<span class="string">"图片描述"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"image-caption"</span>&gt;</span></span><br><span class="line">            图片描述</span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- TAG写法（不建议）</span></span><br><span class="line"><span class="comment">&#123;% fancybox %&#125;</span></span><br><span class="line"><span class="comment">![图片描述](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg)</span></span><br><span class="line"><span class="comment">&#123;% endfancybox %&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><div class="gallery ">    <p>    <div class="fancybox">        <img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg"            alt="图片描述">        <span class="image-caption">            图片描述        </span>    </div>    </p></div><h4 id="一行多个图片（不换行）"><a href="#一行多个图片（不换行）" class="headerlink" title="一行多个图片（不换行）"></a>一行多个图片（不换行）</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"gallery "</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"fancybox"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">alt</span>=<span class="string">"图片描述"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"image-caption"</span>&gt;</span>图片描述<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"fancybox"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">alt</span>=<span class="string">"图片描述"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"image-caption"</span>&gt;</span>图片描述<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"fancybox"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">alt</span>=<span class="string">"图片描述"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"image-caption"</span>&gt;</span>图片描述<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- TAG写法 不推荐</span></span><br><span class="line"><span class="comment">&#123;% fancybox %&#125;</span></span><br><span class="line"><span class="comment">![图片描述](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg)</span></span><br><span class="line"><span class="comment">![图片描述](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg)</span></span><br><span class="line"><span class="comment">![图片描述](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/00E0F0ED-9F1C-407A-9AA6-545649D919F4.jpeg)</span></span><br><span class="line"><span class="comment">&#123;% endfancybox %&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><div class="gallery ">    <p>    <div class="fancybox">        <img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg"             alt="图片描述">        <span class="image-caption">图片描述</span>    </div><br>    <div class="fancybox">        <img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg"             alt="图片描述">        <span class="image-caption">图片描述</span>    </div><br>    <div class="fancybox">        <img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg"             alt="图片描述">        <span class="image-caption">图片描述</span>    </div>    </p></div><h4 id="多行多个图片"><a href="#多行多个图片" class="headerlink" title="多行多个图片"></a>多行多个图片</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% fancybox stretch, 4 %&#125;</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg)</span><br><span class="line">&#123;% endfancybox %&#125;</span><br></pre></td></tr></table></figure><div class="gallery stretch" col='4'>              <p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg" alt=""><br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg" alt=""><br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg" alt=""><br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg" alt=""><br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg" alt=""><br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/AEB33F9D-7294-4CF1-B8C5-3020748A9D45.jpeg" alt=""><br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg" alt=""><br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/10A0FCE5-36A1-4AD0-8CF0-019259A89E03.jpeg" alt=""></p>            </div><h2 id="文章内音乐"><a href="#文章内音乐" class="headerlink" title="文章内音乐"></a>文章内音乐</h2><h3 id="Aplayer"><a href="#Aplayer" class="headerlink" title="Aplayer"></a>Aplayer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% aplayerlist %&#125;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;narrow&quot;: false,&#x2F;&#x2F; （可选）播放器袖珍风格</span><br><span class="line">    &quot;autoplay&quot;: true,&#x2F;&#x2F; （可选) 自动播放，移动端浏览器暂时不支持此功能</span><br><span class="line">    &quot;mode&quot;: &quot;random&quot;,&#x2F;&#x2F; （可选）曲目循环类型，有 &#39;random&#39;（随机播放）, &#39;single&#39; (单曲播放), &#39;circulation&#39; (循环播放), &#39;order&#39; (列表播放)， 默认：&#39;circulation&#39;</span><br><span class="line">    &quot;showlrc&quot;: 3,&#x2F;&#x2F; （可选）歌词显示配置项，可选项有：1,2,3</span><br><span class="line">    &quot;mutex&quot;: true,&#x2F;&#x2F; （可选）该选项开启时，如果同页面有其他 aplayer 播放，该播放器会暂停</span><br><span class="line">    &quot;theme&quot;: &quot;#e6d0b2&quot;,&#x2F;&#x2F; （可选）播放器风格色彩设置，默认：#b7daff</span><br><span class="line">    &quot;preload&quot;: &quot;metadata&quot;,&#x2F;&#x2F; （可选）音乐文件预载入模式，可选项： &#39;none&#39; &#39;metadata&#39; &#39;auto&#39;, 默认: &#39;auto&#39;</span><br><span class="line">    &quot;listmaxheight&quot;: &quot;513px&quot;,&#x2F;&#x2F; (可选) 该播放列表的最大长度</span><br><span class="line">    &quot;music&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;title&quot;: &quot;CoCo&quot;,</span><br><span class="line">            &quot;author&quot;: &quot;Jeff Williams&quot;,</span><br><span class="line">            &quot;url&quot;: &quot;caffeine.mp3&quot;,</span><br><span class="line">            &quot;pic&quot;: &quot;caffeine.jpeg&quot;,</span><br><span class="line">            &quot;lrc&quot;: &quot;caffeine.txt&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;title&quot;: &quot;アイロニ&quot;,</span><br><span class="line">            &quot;author&quot;: &quot;鹿乃&quot;,</span><br><span class="line">            &quot;url&quot;: &quot;irony.mp3&quot;,</span><br><span class="line">            &quot;pic&quot;: &quot;irony.jpg&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">&#123;% endaplayerlist %&#125;</span><br></pre></td></tr></table></figure><p>简单示例</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% meting &quot;60198&quot; &quot;netease&quot; &quot;playlist&quot; %&#125;</span><br></pre></td></tr></table></figure>    <div id="aplayer-fdrimeMo" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="60198" data-server="netease" data-type="playlist" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#ad7a86"    ></div><p>进阶示例</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% meting &quot;60198&quot; &quot;netease&quot; &quot;playlist&quot; &quot;autoplay&quot; &quot;mutex:false&quot; &quot;listmaxheight:340px&quot; &quot;preload:none&quot; &quot;theme:#ad7a86&quot;%&#125;</span><br></pre></td></tr></table></figure>    <div id="aplayer-GpQlSiHb" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="60198" data-server="netease" data-type="playlist" data-mode="circulation" data-autoplay="false" data-mutex="false" data-listmaxheight="340px" data-preload="none" data-theme="#ad7a86"    ></div><h3 id="Audio"><a href="#Audio" class="headerlink" title="Audio"></a>Audio</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;audio controls&#x3D;&quot;&quot; preload&#x3D;&quot;&quot; __idm_id__&#x3D;&quot;269361153&quot;&gt;</span><br><span class="line">  &lt;source</span><br><span class="line">    src&#x3D;&quot;http:&#x2F;&#x2F;music.163.com&#x2F;song&#x2F;media&#x2F;outer&#x2F;url?id&#x3D;574566207.mp3&quot;</span><br><span class="line">    type&#x3D;&quot;audio&#x2F;mp3&quot;</span><br><span class="line">  &#x2F;&gt;</span><br><span class="line">  Your browser does not support the audio tag.</span><br><span class="line">&lt;&#x2F;audio&gt;</span><br></pre></td></tr></table></figure><audio controls="" preload="" __idm_id__="269361153">  <source    src="http://music.163.com/song/media/outer/url?id=574566207.mp3"    type="audio/mp3"  />  Your browser does not support the audio tag.</audio><h2 id="轮播图"><a href="#轮播图" class="headerlink" title="轮播图"></a>轮播图</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">  <span class="function"><span class="keyword">function</span> <span class="title">tt</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">".demo"</span>).slider(&#123;</span></span><br><span class="line">      imgList: [</span><br><span class="line">        &#123;</span><br><span class="line">          img:</span><br><span class="line"><span class="actionscript">            <span class="string">"https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/13/2a877ea5da1292c817cbc2a254c01c31.png"</span>,</span></span><br><span class="line"><span class="actionscript">          a: <span class="string">"跳转url地址"</span>,</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          img:</span><br><span class="line"><span class="actionscript">            <span class="string">"https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/13/5005109d1aa2ffd28984c2b02b8cbfbe.png"</span>,</span></span><br><span class="line"><span class="actionscript">          a: <span class="string">"跳转url地址"</span>,</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          img:</span><br><span class="line"><span class="actionscript">            <span class="string">"https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/13/163a2ade4361d1ed705ed523091af67e.png"</span>,</span></span><br><span class="line"><span class="actionscript">          a: <span class="string">"跳转url地址"</span>,</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">      ], <span class="comment">//图片的列表，a属性里面存放的是网络地址，img存放的是图片地址</span></span></span><br><span class="line"><span class="actionscript">      width: <span class="string">"100%"</span>, <span class="comment">//图片的宽</span></span></span><br><span class="line"><span class="actionscript">      height: <span class="number">500</span>, <span class="comment">//图片的高</span></span></span><br><span class="line"><span class="actionscript">      isAuto: <span class="literal">false</span>, <span class="comment">//是否自动轮播</span></span></span><br><span class="line"><span class="actionscript">      moveTime: <span class="number">3000</span>, <span class="comment">//运动时间</span></span></span><br><span class="line"><span class="actionscript">      direction: <span class="string">"right"</span>, <span class="comment">//轮播的方向</span></span></span><br><span class="line"><span class="actionscript">      btnWidth: <span class="number">30</span>, <span class="comment">//按钮的宽</span></span></span><br><span class="line"><span class="actionscript">      btnHeight: <span class="number">30</span>, <span class="comment">//按钮的高</span></span></span><br><span class="line"><span class="actionscript">      spanWidth: <span class="number">10</span>, <span class="comment">//span按钮的宽</span></span></span><br><span class="line"><span class="actionscript">      spanHeight: <span class="number">10</span>, <span class="comment">//span按钮的高</span></span></span><br><span class="line"><span class="actionscript">      spanColor: <span class="string">"#fff"</span>, <span class="comment">//span按钮的颜色</span></span></span><br><span class="line"><span class="actionscript">      activeSpanColor: <span class="string">"red"</span>, <span class="comment">//选中的span颜色</span></span></span><br><span class="line"><span class="actionscript">      btnBackgroundColor: <span class="string">"rgba(0, 0, 0, 0.3)"</span>, <span class="comment">//两侧按钮的颜色</span></span></span><br><span class="line"><span class="actionscript">      spanRadius: <span class="string">"50%"</span>, <span class="comment">//span按钮的圆角程度</span></span></span><br><span class="line"><span class="actionscript">      spanMargin: <span class="number">3</span>, <span class="comment">//span之间的距离</span></span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="javascript">  <span class="built_in">window</span>.addEventListener(<span class="string">"DOMContentLoaded"</span>, tt);</span></span><br><span class="line"><span class="actionscript">  <span class="comment">// 或者 window.addEventListener('load',tt)</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="demo"></div><script>  function tt() {    $(".demo").slider({      imgList: [        {          img:            "https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/13/2a877ea5da1292c817cbc2a254c01c31.png",          a: "跳转url地址",        },        {          img:            "https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/13/5005109d1aa2ffd28984c2b02b8cbfbe.png",          a: "跳转url地址",        },        {          img:            "https://cdn.jsdelivr.net/gh/blogimg/picbed@master/2020/04/13/163a2ade4361d1ed705ed523091af67e.png",          a: "跳转url地址",        },      ], //图片的列表，a属性里面存放的是网络地址，img存放的是图片地址      width: "100%", //图片的宽      height: 500, //图片的高      isAuto: false, //是否自动轮播      moveTime: 3000, //运动时间      direction: "right", //轮播的方向      btnWidth: 30, //按钮的宽      btnHeight: 30, //按钮的高      spanWidth: 10, //span按钮的宽      spanHeight: 10, //span按钮的高      spanColor: "#fff", //span按钮的颜色      activeSpanColor: "red", //选中的span颜色      btnBackgroundColor: "rgba(0, 0, 0, 0.3)", //两侧按钮的颜色      spanRadius: "50%", //span按钮的圆角程度      spanMargin: 3, //span之间的距离    });  }  window.addEventListener("DOMContentLoaded", tt);  // 或者 window.addEventListener('load',tt)</script>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java面试题 -- MySQL面试题</title>
      <link href="/posts/202006161624.html/"/>
      <url>/posts/202006161624.html/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="数据库类型"><a href="#数据库类型" class="headerlink" title="数据库类型"></a>数据库类型</h2><h3 id="关系型数据库"><a href="#关系型数据库" class="headerlink" title="关系型数据库"></a>关系型数据库</h3><p>​        关系型数据库是建立在关系模型上的数据库，借助于集合代数等数学概念和方法来处理数据库中的数据。简单说，关系型数据库就是由多张可以互相连接的表组成的数据库。</p><p><strong>优点：</strong></p><pre><code>1. 都是使用表结构，格式一致，方便维护 2. 使用通用的SQL语言操作，使用方便，可用于复杂查询 3. 数据库存储在磁盘，安全</code></pre><p><strong>缺点：</strong></p><pre><code>1. 读写性能比较差，无法满足海量数据的高效率读写； 2. 不节省空间，因为建立在关系模型上，就需要遵循某些规则，比如数据库中的空值仍要分配空间 3. 固定的表结构，灵活性低</code></pre><p><strong>常见的关系型数据库有哪些：</strong></p><p>​    <strong>MySQL</strong>、<strong>Oracle</strong>、<strong>SQL Server</strong>、 PostgreSQL 等</p><h3 id="非关系型数据库"><a href="#非关系型数据库" class="headerlink" title="非关系型数据库"></a>非关系型数据库</h3><p>​        非关系型数据库又称为NoSQL（not only SQL），意为不仅仅是SQL。通常指数据以对象的形式存储在数据库中，而对象之间的关系通过每个对象自身的属性来决定。</p><p><strong>优点：</strong></p><pre><code>1. 非关系型数据库存储数据的格式可以是key-value形式、文档形式、图片形式等，使用灵活，应用场景广泛，而关系型数据库只支持基本类型。 2. 速度快，效率高，NoSQL可以使用硬盘或随机存储器作为载体，而关系型数据库只能保存到磁盘。 3. 海量数据的维护和处理很轻松。 4. 非关系型数据库具有扩展简单、高并发、高稳定性、成本低廉的优势。 5. 可以实现数据的分布式处理。</code></pre><p><strong>缺点：</strong></p><pre><code>1. 非关系型数据库暂时没有提供SQL支持，学习和使用成本较高。 2. 非关系型数据库没有事务处理，没有保证数据的完整性和安全性。适合海量数据，但是不一定安全。 3. 功能没有关系型数据库完善</code></pre><p><strong>常见的非关系型数据库有哪些：</strong></p><p>​    <strong>Redis</strong>、<strong>MongoDB</strong>、Neo4j、Memcached、MemcacheDB、HBase等</p><h2 id="数据库引擎"><a href="#数据库引擎" class="headerlink" title="数据库引擎"></a>数据库引擎</h2><p>​    MySQL支持的数据引擎有 <strong>InnoDB</strong>、<strong>MyISAM</strong>等。</p><p>​    可以使用 <strong>SHOW ENGINES</strong>; 查看<br><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704034727.png" alt=""></p><p><strong>在这里可以看出MySQL默认使用InnoDB引擎</strong></p><p> Support 列的值表示某种引擎是否能使用 ，<strong>YES</strong>表示可用，<strong>NO</strong>不可用，<strong>DEFAULT</strong>表示默认</p><table><thead><tr><th align="center"><strong>存储引擎</strong></th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">InnoDB</td><td align="center">具备外键支持功能的事务处理引擎</td></tr><tr><td align="center">MyISAM</td><td align="center">主要的非事务处理存储引擎</td></tr><tr><td align="center">MEMORY</td><td align="center">置于内存的表</td></tr><tr><td align="center">ARCHIVE</td><td align="center">用于数据存档的引擎，数据被插入后就不能在修改了，且不支持索引。</td></tr><tr><td align="center">CSV</td><td align="center">在存储数据时，会以逗号作为数据项之间的分隔符。</td></tr><tr><td align="center">BLACKHOLE</td><td align="center">会丢弃写操作，该操作会返回空内容。</td></tr><tr><td align="center">FEDERATED</td><td align="center">将数据存储在远程数据库中，用来访问远程表的存储引擎。</td></tr><tr><td align="center">MERGE</td><td align="center">用来管理由多个 MyISAM 表构成的表集合</td></tr><tr><td align="center">NDB</td><td align="center">MySQL 集群专用存储引擎</td></tr></tbody></table><h2 id="常用数据库"><a href="#常用数据库" class="headerlink" title="常用数据库"></a>常用数据库</h2><pre><code>### 0. 常用数据库排名</code></pre><p> <strong><em>\</em><a href="https://db-engines.com/en/ranking" target="_blank" rel="noopener">DB-Engines</a>**</strong>  <strong>2020年6月全球数据库排行</strong> </p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704035455.png" alt=""></p><p><strong>关系型数据库排名</strong></p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704035501.png" alt=""></p><p><strong>非关系型数据库排名</strong></p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704035505.png" alt=""></p><h3 id="关系型数据库-1"><a href="#关系型数据库-1" class="headerlink" title="关系型数据库"></a>关系型数据库</h3><ol><li><p>Oracle</p><p><strong>Oracle</strong>是甲骨文的一款关系型数据库管理系统，在数据库领域一直处于领先的地位， 是目前世界上流行的关系型数据库之一 ，是一种高效率、可靠性好、适应高吞吐量的数据库方案。</p><p><strong>优点：</strong></p><pre><code>1. 可移植性好，可以在所有主流平台运行，完全支持所有工业化标准。 2. 获得最高级认证级别的ISO标准认证，安全性高。 3. 与其他数据库相比，Oracle性能高 4. 多层次网络计算，支持多种标准，可以用ODBC、JDBC、OCI等网络客户连接 5. 完全向下兼容，因此被广泛使用，且风险低</code></pre><p><strong>缺点：</strong></p><pre><code>1. 对硬件的要求高 2. 价格昂贵 3. 管理维护麻烦 4. 操作比较复杂</code></pre></li><li><p>MySQL</p><p> MySQL 是一种开放源代码的关系型数据库管理系统 ，在WEB应用方面，MySQL是最好的应用软件之一</p><p><strong>优点：</strong></p><pre><code>1. 性能卓越服务稳定，很少出现宕机。2. 开源，自主性强，使用成本低3.  历史悠久、社区及用户非常活跃，遇到问题，可以很快获取到帮助。 4.  件体积小，安装使用简单，并且易于维护，安装及维护成本低。 5.  支持多种操作系统，提供多种 API 接口，支持多种开发语言。 </code></pre><p><strong>缺点：</strong></p><pre><code>1.  ySQL 最大的缺点是其安全系统，主要是复杂而非标准，只有调用 mysqladmin 来重读用户权限才会发生改变。  2.   MySQL 不允许调试存储过程，开发和维护存储过程很难。  3.   MySQL 不支持热备份。  4.   MySQL 的价格随平台和安装方式变化。 </code></pre></li></ol><h3 id="非关系型数据库-1"><a href="#非关系型数据库-1" class="headerlink" title="非关系型数据库"></a>非关系型数据库</h3><ol><li><p>Redis</p><p> <a href="http://c.biancheng.net/redis/" target="_blank" rel="noopener">Redis</a> 是当前互联网世界最为流行的 <a href="http://c.biancheng.net/nosql/" target="_blank" rel="noopener">NoSQL</a>（Not Only SQL）数据库。 </p><ol><li><p>响应快速</p><p> Redis 响应非常快，每秒可以执行大约 110 000 个写入操作，或者 81 000 个读操作，其速度远超数据库。如果存入一些常用的数据，就能有效提高系统的性能。 </p></li><li><p>支持6中数据类型</p><p> 它们是<strong>字符串</strong>、<strong>哈希结构</strong>、<strong>列表</strong>、<strong>集合</strong>、<strong>可排序集合</strong>和<strong>基数</strong>。比如对于字符串可以存入一些 Java基础数据类型，哈希可以存储对象，列表可以存储 List 对象等。这使得在应用中很容易根据自己的需要选择存储的数据类型，方便开发。 </p><p> 对于 Redis 而言，虽然只有 6 种数据类型，但是有两大好处：一方面可以满足存储各种数据结构体的需要；另外一方面数据类型少，使得规则就少，需要的判断和逻辑就少，这样读/写的速度就更快。 </p></li><li><p>操作都是原子的</p><p> 所有 Redis 的操作都是原子的，从而确保当两个客户同时访问 Redis 服务器时，得到的是更新后的值（最新值）。  在需要高并发的场合可以考虑使用 Redis 的事务，处理一些需要锁的业务。</p></li></ol></li></ol><h2 id="MySQL数据库的事务特性"><a href="#MySQL数据库的事务特性" class="headerlink" title="MySQL数据库的事务特性"></a>MySQL数据库的事务特性</h2><h3 id="事务概念"><a href="#事务概念" class="headerlink" title="事务概念"></a>事务概念</h3><p>​    事务就是一个程序执行单元，里面的操作要么全部执行完成，要么全部都不执行</p><h3 id="事务特性（ACID）"><a href="#事务特性（ACID）" class="headerlink" title="事务特性（ACID）"></a>事务特性（ACID）</h3><p>​    事务有4个非常重要的特性</p><pre><code>1. Atomicity 原子性 ：事务是不可分割的整体，所有操作要么全做，要么全不做；只要事务中有一个操作出错，回滚到事务开始前状态，即之前已经执行的操作无效 2. Consistency 一致性：事务执行后，从一个一致性状态到另一个一致性状态；比如A向B转账，（A、B总金额是一个一致性状态）不可能出现A扣了钱，但B没收到 3. Isolation 隔离性：多个事务之间相互隔离，互不干扰 4. Durablity 持久性：事务完成后，对数据库的更改是永久保存的，不能回滚</code></pre><h3 id="事务并发问题"><a href="#事务并发问题" class="headerlink" title="事务并发问题"></a>事务并发问题</h3><pre><code>1. 脏读：一个事务读取到了另一个事务未提交的数据 2. 幻读：多次读取到的结果不一致。（被另一个事物新增 或 删除了记录） 3. 不可重复读：一个事务多次读取同一数据，得到了不同的值。（被另一个事务更新了）</code></pre><h3 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h3><ol><li><p>读未提交（read-uncommitted）</p></li><li><p>读已提交（read-committed）解决脏读</p></li><li><p>可重复读（Repeatable read）解决脏读、不可重复读</p></li><li><p>串行化（Serializable）解决脏读，不可重复读、幻读</p><p>MySQL默认隔离级别是<strong>Repeatable read</strong>，级别越高，性能就越低</p><ol><li>查看当前会话隔离级别<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @@tx_isolation;</span><br></pre></td></tr></table></figure></li><li>查看系统当前隔离级别<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @@global.tx_isolation;</span><br></pre></td></tr></table></figure></li><li>设置当前会话隔离级别<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">session</span> <span class="keyword">transaction</span> isolatin <span class="keyword">level</span> repeatable <span class="keyword">read</span>;</span><br></pre></td></tr></table></figure></li><li>设置系统当前隔离级别<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> repeatable <span class="keyword">read</span>;</span><br></pre></td></tr></table></figure></li></ol><p>Oracle默认隔离级别是<strong>read-committed</strong>，读已提交<br>Oracle数据库支持READ COMMITTED 和 SERIALIZABLE这两种事务隔离级别。</p><ol><li>查看系统默认事务隔离级别,也是当前会话隔离级别<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 首先创建一个事务</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">    trans_id <span class="built_in">Varchar2</span>(<span class="number">100</span>);</span><br><span class="line">   <span class="keyword">begin</span></span><br><span class="line">    trans_id := dbms_transaction.local_transaction_id( <span class="literal">TRUE</span> );</span><br><span class="line">   <span class="keyword">end</span>; </span><br><span class="line"><span class="comment">-- 查看事务隔离级别</span></span><br><span class="line"><span class="keyword">SELECT</span> s.sid, s.serial<span class="comment">#,</span></span><br><span class="line">    <span class="keyword">CASE</span> BITAND(t.flag, <span class="keyword">POWER</span>(<span class="number">2</span>, <span class="number">28</span>))</span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">0</span> <span class="keyword">THEN</span> <span class="string">'READ COMMITTED'</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">'SERIALIZABLE'</span></span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">AS</span> isolation_level</span><br><span class="line"><span class="keyword">FROM</span> v$<span class="keyword">transaction</span> t</span><br><span class="line"><span class="keyword">JOIN</span> v$<span class="keyword">session</span> s <span class="keyword">ON</span> t.addr = s.taddr <span class="keyword">AND</span> s.sid = sys_context(<span class="string">'USERENV'</span>, <span class="string">'SID'</span>);</span><br></pre></td></tr></table></figure></li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> 面试题 </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 面试 </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java面试题 --- final、finally、finalize的区别</title>
      <link href="/posts/202006151725.html/"/>
      <url>/posts/202006151725.html/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="final"><a href="#final" class="headerlink" title="final"></a>final</h2><ol><li><p>基本介绍</p><p>​    <strong>final</strong>是Java中的关键字，修饰符，可用来修饰属性、方法、类</p><p>1.1、修饰属性，表示修饰的属性不可更改</p><p>​    被声明为final的变量，必须在声明时给定初始值，在以后的引用中，只能使用，不能修改</p><p>1.2、修饰方法，表示修饰的方法不可被覆盖（重写）</p><p>​    被声明为final的方法只能使用，不可以修改</p><p>1.3、修饰类，表示修饰的类不可被继承</p><p>​    如果一个类被声明了final，就说明它不可能再派生出新的子类，因此，用一个类<strong>不可以同时</strong>声明为<strong>abstract抽象类</strong>和<strong>final</strong>的类</p></li><li><p>详细介绍</p><ol><li><p>修饰属性</p><p>​    如果final修饰的是基本数据类型，表示这个变量被赋予的值是不可更改的，即它是个常量；</p><p>​    如果final修饰的是一个对象，表示这个变量被赋予的引用是不可改变的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> A = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">final</span> User USER = <span class="keyword">new</span> User();</span><br><span class="line">    </span><br><span class="line"><span class="comment">//    编译报错，被final修饰的变量或对象，初始化后都不可被再次改变</span></span><br><span class="line"><span class="comment">//    A = 20;</span></span><br><span class="line"><span class="comment">//    USER = new User();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​    如果一个<strong>变量</strong>或<strong>方法参数</strong>被final修饰，就表示它只能被赋值一次，但是JVM虚拟机为变量设定的默认值不记作一次赋值。被final修饰的变量必须被初始化，初始化的几种方式：</p><p>​    1、在定义的时候初始化</p><p>​    2、可以在初始化块中初始化，不可以在静态初始化块中初始化</p><p>​    3、静态final变量可以在定义时初始化，也可以在静态初始化块中初始化，但不可以在初始化块中初始化</p><p>​    4、final变量可以在类的构造器内初始化，但是静态final不可以</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"><span class="comment">//    在定义时初始化</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> A1 = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> A2 = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    在初始化块中初始化</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> B1;&#123; B1 = <span class="number">10</span>; &#125;</span><br><span class="line"><span class="comment">//    public static final int B2;&#123; B2 = 10; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    在静态初始化块中初始化</span></span><br><span class="line"><span class="comment">//    public final int C1;static &#123; C1 = 10; &#125;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> C2;<span class="keyword">static</span> &#123; C2 = <span class="number">10</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    在构造函数中初始化</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> D1;</span><br><span class="line"><span class="comment">//    public static final int D2;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Demo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        D1 = <span class="number">10</span>;</span><br><span class="line"><span class="comment">//        D2 = 10;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">初始化</th><th align="center">在定义时</th><th align="center">在初始化块中</th><th align="center">在静态初始化块中</th><th align="center">在构造函数中</th></tr></thead><tbody><tr><td align="center">静态常量</td><td align="center">√</td><td align="center"></td><td align="center">√</td><td align="center"></td></tr><tr><td align="center">非静态常量</td><td align="center">√</td><td align="center">√</td><td align="center"></td><td align="center">√</td></tr></tbody></table></li><li><p>修饰方法</p><p>当final修饰一个方法时，表示这个方法不可被子类重写，但还是可以继承的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello World!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"People eat meat"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">eating</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"People eat meat......"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">People</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*public void say()&#123;</span></span><br><span class="line"><span class="comment">        System.out.println("你好");</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Student eat vegetable"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">eating</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Student eat vegetable......"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line"></span><br><span class="line">        student.say();  <span class="comment">//输出结果：Hello World!</span></span><br><span class="line">        student.eat();  <span class="comment">//输出结果：Student eat vegetable</span></span><br><span class="line">        student.eating();   <span class="comment">//输出结果：Student eat vegetable......</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具有private权限的方法也可以用final修饰，但是由于子类无法继承private方法，因此也无法重写。</p><p>编译器在处理private方法时，是按照被final修饰的方法来处理，这样可以提高该方法被调用时的效率。</p><p>子类仍然可以定义与父类中private方法具有同样结构的同名方法，但是这并不是重写，二者并无关联</p></li></ol></li></ol><pre><code>3. 修饰类   final修饰的类不可被继承，比如String类，就是final修饰的   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span>&lt;<span class="title">String</span>&gt;, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">...<span class="comment">//code</span></span><br><span class="line">    ...<span class="comment">//code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>   由于abstract关键字修饰的类为抽象类，其方法为抽象方法，需要有其子类来重载实现抽象方法，因此abstract关键字和final关键字不可同时用来修饰一个类。   同理，final也不可用来修饰接口。   final修饰的类的所有方法都不可被重写，但其中没有被final修饰的变量可以被修改   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> b = <span class="number">20</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Demo demo = <span class="keyword">new</span> Demo();</span><br><span class="line">        demo.a = <span class="number">100</span>;</span><br><span class="line"><span class="comment">//        demo.b = 200;</span></span><br><span class="line">        System.out.println(demo.a);<span class="comment">//输出结果：100</span></span><br><span class="line">        System.out.println(demo.b);<span class="comment">//输出结果：20</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre><h2 id="finally"><a href="#finally" class="headerlink" title="finally"></a>finally</h2><p>​    finally作为异常处理的一部分，只能用在try…catch语句中，并且附带着一个语句块，表示这段语句最终一定会执行，<strong>经常被用在需要释放资源的情况下</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"程序结束，finally语句块执行"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 输出结果</span></span><br><span class="line"><span class="comment">java.lang.ArithmeticException: / by zero</span></span><br><span class="line"><span class="comment">at com.demo.Demo.main(Demo.java:4)</span></span><br><span class="line"><span class="comment">程序结束，finally语句块执行</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p>很多人认为finally语句块一定会执行，其实是不一定</p><ol><li><p>try/catch语句块没有执行到，程序就结束了，finally语句块无法执行</p><p>方法被返回，执行了return语句；</p><p>在try/catch之前，出现了异常，程序中断；</p></li><li><p>执行到try/catch，但Java虚拟机被终止运行</p><p>在try语句块内执行了System.exit(0); JVM终止</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//没有执行到try/catch语句块，finally不会执行</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//i = i / 0;</span></span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            i = i/<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"程序结束，finally语句块执行"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Demo demo = <span class="keyword">new</span> Demo();</span><br><span class="line">        <span class="keyword">int</span> test = demo.test(<span class="number">1</span>);</span><br><span class="line">        System.out.println(test);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//程序中止</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.exit(<span class="number">0</span>);<span class="comment">//在try语句块中，中止程序，finally语句块无法执行</span></span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"程序结束，finally语句块执行"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="finalize"><a href="#finalize" class="headerlink" title="finalize"></a>finalize</h2><p>finalize是Object类的一个方法，它的方法定义如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123; &#125;</span><br></pre></td></tr></table></figure><p>finalize()是GC（ garbagecollector 垃圾回收器）运行机制的一部分。finalize()方法是在GC清理它所丛属的对象时被调用的，如果在执行它的过程中抛出了无法捕获的异常，GC将终止这次对该对象的清理，并且该异常会被忽略，知道下一次GC开始清理这个对象时，会再次调用finalize()方法</p>]]></content>
      
      
      <categories>
          
          <category> Java基础 </category>
          
          <category> 面试题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java面试题 -- ==和equals的区别</title>
      <link href="/posts/202006150304.html/"/>
      <url>/posts/202006150304.html/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="“-”的含义"><a href="#“-”的含义" class="headerlink" title="“==”的含义"></a>“==”的含义</h3><p>在Java中，主要有两个作用</p><h4 id="比较基本数据类型（byte、short、int、long、float、double、char、boolean）"><a href="#比较基本数据类型（byte、short、int、long、float、double、char、boolean）" class="headerlink" title="比较基本数据类型（byte、short、int、long、float、double、char、boolean）"></a>比较基本数据类型（byte、short、int、long、float、double、char、boolean）</h4><p>比较值是否相等，比如两个int类型，比较的是两个变量值是否相等</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">12</span>;</span><br><span class="line">    System.out.println(a == b);<span class="comment">//输出结果：false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="比较引用数据类型（数组、类、接口）"><a href="#比较引用数据类型（数组、类、接口）" class="headerlink" title="比较引用数据类型（数组、类、接口）"></a>比较引用数据类型（数组、类、接口）</h4><p>比较的是引用地址是否相同</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">User user1 = <span class="keyword">new</span> User(<span class="string">"张三"</span>, <span class="number">20</span>);</span><br><span class="line">User user2 = <span class="keyword">new</span> User(<span class="string">"张三"</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//System.identityHashCode(Object)方法可以返回对象的内存地址</span></span><br><span class="line">System.out.println(System.identityHashCode(user1));<span class="comment">//输出结果：603742814</span></span><br><span class="line">System.out.println(System.identityHashCode(user2));<span class="comment">//输出结果：1067040082</span></span><br><span class="line"></span><br><span class="line">System.out.println(user1 == user2);<span class="comment">//输出结果：false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="“equals”的含义"><a href="#“equals”的含义" class="headerlink" title="“equals”的含义"></a>“equals”的含义</h3><p>在Java中，Object类里有equals方法，String类里也有equals方法</p><ol><li><p>Object类中的equals</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>   obj   the reference object with which to compare.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>  &#123;<span class="doctag">@code</span> true&#125; if this object is the same as the obj</span></span><br><span class="line"><span class="comment"> *          argument; &#123;<span class="doctag">@code</span> false&#125; otherwise.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span>     #hashCode()</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span>     java.util.HashMap</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>阅读源码发现，比较的是当前对象的引用和obj的引用是否相同，也就是说<strong>默认比较的是地址</strong>。</p><p>其中<strong>return (this == obj);</strong> 使用的也是<strong>“==”</strong>进行判断，所以，在这里 <strong>==</strong> 比较的是引用的地址，而<strong>equals</strong>也是比较的引用的地址，所以，<strong>==</strong>和<strong>equals</strong>在这里的效果是一样的，都是比较引用的地址。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">User user1 = <span class="keyword">new</span> User(<span class="string">"张三"</span>, <span class="number">20</span>);</span><br><span class="line">    User user2 = <span class="keyword">new</span> User(<span class="string">"张三"</span>, <span class="number">20</span>);</span><br><span class="line"><span class="comment">//  比较的是普通对象User，==和equals的作用是一样的</span></span><br><span class="line">    System.out.println(user1 == user2);<span class="comment">//输出结果：false</span></span><br><span class="line">System.out.println(user1.equals(user2));<span class="comment">//输出结果：false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>String类中的equals</p><p>Object对象里的 == 和 equals 没什么区别，意义不大，所以String在Object的基础上重写了equals。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  anObject</span></span><br><span class="line"><span class="comment"> *         The object to compare this &#123;<span class="doctag">@code</span> String&#125; against</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>  &#123;<span class="doctag">@code</span> true&#125; if the given object represents a &#123;<span class="doctag">@code</span> String&#125;</span></span><br><span class="line"><span class="comment"> *          equivalent to this string, &#123;<span class="doctag">@code</span> false&#125; otherwise</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span>  #compareTo(String)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span>  #equalsIgnoreCase(String)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object anObject)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == anObject) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (anObject <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">        String anotherString = (String)anObject;</span><br><span class="line">        <span class="keyword">int</span> n = value.length;</span><br><span class="line">        <span class="keyword">if</span> (n == anotherString.value.length) &#123;</span><br><span class="line">            <span class="keyword">char</span> v1[] = value;</span><br><span class="line">            <span class="keyword">char</span> v2[] = anotherString.value;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (n-- != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v1[i] != v2[i])</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将此字符串与指定对象进行比较。当且仅当参数不是 null 且是一个 String 对象，表示与此对象相同的字符序列时，结果为 true 。</p><p>String类中的equals方法比较的是字符串内容是否一致。</p><p>注意：像String、Date这些重写了equals的类，使用的时候会与Object类的equals不一样</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String str1 = <span class="string">"Hello"</span>;</span><br><span class="line">    String str2 = <span class="keyword">new</span> String(<span class="string">"Hello"</span>);</span><br><span class="line">    String str3 = str2;</span><br><span class="line"></span><br><span class="line">    System.out.println(str1 == str2);       <span class="comment">//输出结果：false</span></span><br><span class="line">    System.out.println(str1 == str3);       <span class="comment">//输出结果：false</span></span><br><span class="line">    System.out.println(str2 == str3);       <span class="comment">//输出结果：true</span></span><br><span class="line">    System.out.println(str1.equals(str2));  <span class="comment">//输出结果：true</span></span><br><span class="line">    System.out.println(str1.equals(str3));  <span class="comment">//输出结果：true</span></span><br><span class="line">    System.out.println(str2.equals(str3));  <span class="comment">//输出结果：true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>内存解释</p><p>在Java中，一般把对象放在堆区，对象的引用放在栈区。</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704025413.png" alt=""></p><p>3.1    String str1 = “Hello”; 是在堆区存放一个字符串对象<br>3.2    String str2 = new String(“Hello”); 是在堆区重新存放一个字符串对象</p><p>3.3    String str3 = str2;    这个时候str3和str2是不同的引用，但指向的是同一个字符串对象</p></li></ol><ol start="4"><li><p>总结</p><ol><li>基础类型比较</li></ol><p>使用 <strong>==</strong> 比较值是否相等</p><ol start="2"><li><p>引用类型比较</p><ol start="3"><li><p>重写了equals方法，比如String、Date</p><p>第一种情况：使用 == 比较的是String的引用是否指向同一内存地址</p><p>第二种情况：使用 equals 比较的是String的引用的对象内容是否相同</p></li><li><p>没有重写equals方法，比如自定义类User</p><p>== 和 equals 比较的都是引用是否指向同一内存地址</p></li></ol></li><li><p>特例</p><p>String类型中，会有一个小问题</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String str1 = <span class="string">"Hello"</span>;</span><br><span class="line">    String str2 = <span class="keyword">new</span> String(<span class="string">"Hello"</span>);</span><br><span class="line">    str2 = str2.intern();</span><br><span class="line"></span><br><span class="line">    System.out.println(str1 == str2);       <span class="comment">//true</span></span><br><span class="line">    System.out.println(str1.equals(str2));  <span class="comment">//true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当调用intern方法时，如果池中已经包含一个由 equals(Object) 方法确定的等于此 String 对象的字符串，则返回来自池的字符串。否则，将此 String 对象添加到池中，并返回对此String 对象的引用。</p><p>意思就是检查字符串池里是否存在，如果存在，就用池里的字符串对象，如果不存在，就重新添加</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Java基础 </category>
          
          <category> 面试题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次Vue面试</title>
      <link href="/posts/202006120238.html/"/>
      <url>/posts/202006120238.html/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h1><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704034032.png" alt=""></p><h2 id="什么是钩子函数"><a href="#什么是钩子函数" class="headerlink" title="什么是钩子函数"></a>什么是钩子函数</h2><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704034112.png" alt=""></p><p>关键字：<strong>在系统级对所有消息和事件进行过滤</strong></p><p>​                是说钩子函数是在一个事件触发的时候，在系统级捕获到了它，然后做一些操作。</p><p>关键字：<strong>一段用以处理系统消息的程序</strong></p><p>​                钩子函数是用来处理系统消息的</p><p>总结：</p><p>​        1、钩子函数，顾名思义是个函数，在系统消息触发时被系统调用</p><p>​        2、 不是用户自己触发的</p><h2 id="常见的钩子函数"><a href="#常见的钩子函数" class="headerlink" title="常见的钩子函数"></a>常见的钩子函数</h2><h3 id="React的生命周期函数"><a href="#React的生命周期函数" class="headerlink" title="React的生命周期函数"></a>React的生命周期函数</h3><h3 id="Vue的生命周期函数"><a href="#Vue的生命周期函数" class="headerlink" title="Vue的生命周期函数"></a>Vue的生命周期函数</h3><h2 id="Vue的双向绑定"><a href="#Vue的双向绑定" class="headerlink" title="Vue的双向绑定"></a>Vue的双向绑定</h2><h3 id="MVC模式"><a href="#MVC模式" class="headerlink" title="MVC模式"></a>MVC模式</h3><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704034238.png" alt=""></p><p>以往的MVC模式是单向绑定，即Model绑定到View，当我们用JavaScript代码更新Model时，View就会自动更新 </p><pre><code>### 1.3.1、MVVM模式</code></pre><p>​        说到Vue的双向绑定首先联系到的就是MVVM(Model-View-ViewModel)模式了，如下图所示，当试图发生改变的时候传递给VM,再让数据得到更新，当数据发生改变的时候传给VM,使得试图发生改变；</p><p>​        MVVM模式是通过以下三个核心组件组成，每个都有它自己独特的角色：</p><p>​            <strong>Model</strong> - 包含了业务和验证逻辑的数据模型</p><p>​            <strong>View</strong> - 定义屏幕中View的结构，布局和外观</p><p>​            <strong>ViewModel</strong> - 扮演“View”和“Model”之间的使者，帮忙处理 <strong>View</strong> 的全部业务逻辑 </p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704034318.png" alt=""></p><pre><code>### 1.3.2、Vue数据双向绑定原理</code></pre><p>​        Vue的双向绑定主要通过 <strong>Object.defineProperty()</strong> 方法来进行<strong>数据劫持</strong>以及<strong>发布者-订阅</strong>模式来实现的。</p><p>​        1、 Vue是怎么实现数据劫持的？</p><p>​                Vue实例化的时候会去遍历所有属性，给这些属性添加get和set方法进行数据劫持</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704034342.png" alt=""></p><h3 id="双向绑定的具体实现？"><a href="#双向绑定的具体实现？" class="headerlink" title="双向绑定的具体实现？"></a>双向绑定的具体实现？</h3><p>​    1、实现一个监听器Observer，用来劫持并监听所有属性，如果有变动，就通知订阅者。</p><p>​    2、实现一个订阅者Watcher，每一个Watcher都绑定一个更新函数，Watcher可以收到属性的变化通知并执行响应的函数，从而更新视图。</p><p>​    3、实现一个解析器Compile，可以扫描和解析每个节点的相关指令（v-model、v-on等指令），如果节点存在v-model, v-on等指令，则解析器Compile初始化这类节点的模板数据，使之可以显示在视图上，然后初始化相应的订阅者Watcher</p><p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/SevenKiss/imgPicGo/image/20200704034345.png" alt=""></p><h2 id="Vue中class的用法"><a href="#Vue中class的用法" class="headerlink" title="Vue中class的用法"></a>Vue中class的用法</h2><p>​    Vue中的class有 4 种写法，class和style都属于DOM属性，所以在Vue中使用 :class 和 :style表示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--要给id为app的元素添加属性--&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    .green&#123;color:green&#125;</span><br><span class="line">    .red&#123;background-color:red&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--方法一--&gt;</span><br><span class="line">&lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;!--结果为绿色字体，红色背景--&gt;</span><br><span class="line">&lt;span :class&#x3D;&quot;[greens,reds]&quot;&gt;在Vue中使用class&lt;&#x2F;span&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;!--注意，此处需要自行引入vue.js文件--&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;.&#x2F;node_modules&#x2F;vue&#x2F;dist&#x2F;vue.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;scipt&gt;</span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: &quot;#app&quot;,</span><br><span class="line">    data:&#123;</span><br><span class="line">    greens:&quot;green&quot;,</span><br><span class="line">    reds:&quot;red&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;&#x2F;scipt&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--方法二--&gt;</span><br><span class="line">&lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;!--结果为绿色字体，背景不是红色--&gt;</span><br><span class="line">&lt;span :class&#x3D;&quot;&#123;green:true,red:false&#125;&quot;&gt;在Vue中使用class&lt;&#x2F;span&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;.&#x2F;node_modules&#x2F;vue&#x2F;dist&#x2F;vue.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;scipt&gt;</span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: &quot;#app&quot;,</span><br><span class="line">    data:&#123;&#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;&#x2F;scipt&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--方法三--&gt;</span><br><span class="line">&lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;!--结果为默认颜色字体，背景是红色--&gt;</span><br><span class="line">&lt;span :class&#x3D;&quot;demo&quot;&gt;在Vue中使用class&lt;&#x2F;span&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;.&#x2F;node_modules&#x2F;vue&#x2F;dist&#x2F;vue.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;scipt&gt;</span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: &quot;#app&quot;,</span><br><span class="line">    data:&#123;</span><br><span class="line">    demo:&#123;</span><br><span class="line">    green:false,</span><br><span class="line">    red:true</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;&#x2F;scipt&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--方法四--&gt;</span><br><span class="line">&lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;!--结果为绿色字体，背景是红色--&gt;</span><br><span class="line">&lt;span :class&#x3D;&quot;&#123;green:g,red:r&#125;&quot;&gt;在Vue中使用class&lt;&#x2F;span&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;.&#x2F;node_modules&#x2F;vue&#x2F;dist&#x2F;vue.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;scipt&gt;</span><br><span class="line">new Vue(&#123;</span><br><span class="line">    el: &quot;#app&quot;,</span><br><span class="line">    data:&#123;</span><br><span class="line">    demo:&#123;</span><br><span class="line">    g:true,</span><br><span class="line">    r:true</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;&#x2F;scipt&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java基础 </category>
          
          <category> 面试题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 面试 </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
